!function(){function e(n,t,o){function r(a,u){if(!t[a]){if(!n[a]){var s="function"==typeof require&&require;if(!u&&s)return s(a,!0);if(i)return i(a,!0);var c=new Error("Cannot find module '"+a+"'");throw c.code="MODULE_NOT_FOUND",c}var l=t[a]={exports:{}};n[a][0].call(l.exports,function(e){return r(n[a][1][e]||e)},l,l.exports,e,n,t,o)}return t[a].exports}for(var i="function"==typeof require&&require,a=0;a<o.length;a++)r(o[a]);return r}return e}()({1:[function(e,n,t){!function(t,o){"object"==typeof n&&n.exports&&"function"==typeof e?n.exports=o():"function"==typeof define&&"object"==typeof define.amd?define(o):t.log=o()}(this,function(){function e(e){return typeof console!==u&&(void 0!==console[e]?n(console,e):void 0!==console.log?n(console,"log"):a)}function n(e,n){var t=e[n];if("function"==typeof t.bind)return t.bind(e);try{return Function.prototype.bind.call(t,e)}catch(n){return function(){return Function.prototype.apply.apply(t,[e,arguments])}}}function t(e,n){return function(){typeof console!==u&&(o(n),i[e].apply(i,arguments))}}function o(e){for(var n=0;n<s.length;n++){var t=s[n];i[t]=n<e?a:i.methodFactory(t,e)}}function r(e){var n=(s[e]||"silent").toUpperCase();try{return void(window.localStorage.loglevel=n)}catch(e){}try{window.document.cookie="loglevel="+n+";"}catch(e){}}var i={},a=function(){},u="undefined",s=["trace","debug","info","warn","error"];i.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},i.methodFactory=function(n,o){return e(n)||t(n,o)},i.setLevel=function(e,n){if("string"==typeof e&&void 0!==i.levels[e.toUpperCase()]&&(e=i.levels[e.toUpperCase()]),!("number"==typeof e&&e>=0&&e<=i.levels.SILENT))throw"log.setLevel() called with invalid level: "+e;if(!1!==n&&r(e),o(e),typeof console===u&&e<i.levels.SILENT)return"No console available for logging"},i.enableAll=function(e){i.setLevel(i.levels.TRACE,e)},i.disableAll=function(e){i.setLevel(i.levels.SILENT,e)};var c=typeof window!==u?window.log:void 0;return i.noConflict=function(){return typeof window!==u&&window.log===i&&(window.log=c),i},function(){var e;try{e=window.localStorage.loglevel}catch(e){}if(typeof e===u)try{e=/loglevel=([^;]+)/.exec(window.document.cookie)[1]}catch(e){}void 0===i.levels[e]&&(e="WARN"),i.setLevel(i.levels[e],!1)}(),i})},{}],2:[function(e,n,t){!function(e,o){"use strict";var r="model",i="name",a="type",u="vendor",s="version",c="mobile",l="tablet",d={extend:function(e,n){var t={};for(var o in e)n[o]&&n[o].length%2==0?t[o]=n[o].concat(e[o]):t[o]=e[o];return t},has:function(e,n){return"string"==typeof e&&-1!==n.toLowerCase().indexOf(e.toLowerCase())},lowerize:function(e){return e.toLowerCase()},major:function(e){return"string"==typeof e?e.replace(/[^\d\.]/g,"").split(".")[0]:void 0},trim:function(e){return e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}},f={rgx:function(){for(var e,n,t,o,r,i,a,u=0,s=arguments;u<s.length&&!i;){var c=s[u],l=s[u+1];if(void 0===e){e={};for(o in l)l.hasOwnProperty(o)&&(r=l[o],"object"==typeof r?e[r[0]]=void 0:e[r]=void 0)}for(n=t=0;n<c.length&&!i;)if(i=c[n++].exec(this.getUA()))for(o=0;o<l.length;o++)a=i[++t],r=l[o],"object"==typeof r&&r.length>0?2==r.length?"function"==typeof r[1]?e[r[0]]=r[1].call(this,a):e[r[0]]=r[1]:3==r.length?"function"!=typeof r[1]||r[1].exec&&r[1].test?e[r[0]]=a?a.replace(r[1],r[2]):void 0:e[r[0]]=a?r[1].call(this,a,r[2]):void 0:4==r.length&&(e[r[0]]=a?r[3].call(this,a.replace(r[1],r[2])):void 0):e[r]=a||void 0;u+=2}return e},str:function(e,n){for(var t in n)if("object"==typeof n[t]&&n[t].length>0){for(var o=0;o<n[t].length;o++)if(d.has(n[t][o],e))return"?"===t?void 0:t}else if(d.has(n[t],e))return"?"===t?void 0:t;return e}},p={browser:{oldsafari:{version:{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}}},device:{amazon:{model:{"Fire Phone":["SD","KF"]}},sprint:{model:{"Evo Shift 4G":"7373KT"},vendor:{HTC:"APA",Sprint:"Sprint"}}},os:{windows:{version:{ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2000:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"}}}},m={browser:[[/(opera\smini)\/([\w\.-]+)/i,/(opera\s[mobiletab]+).+version\/([\w\.-]+)/i,/(opera).+version\/([\w\.]+)/i,/(opera)[\/\s]+([\w\.]+)/i],[i,s],[/(opios)[\/\s]+([\w\.]+)/i],[[i,"Opera Mini"],s],[/\s(opr)\/([\w\.]+)/i],[[i,"Opera"],s],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/\s]?([\w\.]+)*/i,/(avant\s|iemobile|slim|baidu)(?:browser)?[\/\s]?([\w\.]*)/i,/(?:ms|\()(ie)\s([\w\.]+)/i,/(rekonq)\/([\w\.]+)*/i,/(chromium|flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs)\/([\w\.-]+)/i],[i,s],[/(trident).+rv[:\s]([\w\.]+).+like\sgecko/i],[[i,"IE"],s],[/(edge)\/((\d+)?[\w\.]+)/i],[i,s],[/(yabrowser)\/([\w\.]+)/i],[[i,"Yandex"],s],[/(comodo_dragon)\/([\w\.]+)/i],[[i,/_/g," "],s],[/(micromessenger)\/([\w\.]+)/i],[[i,"WeChat"],s],[/xiaomi\/miuibrowser\/([\w\.]+)/i],[s,[i,"MIUI Browser"]],[/\swv\).+(chrome)\/([\w\.]+)/i],[[i,/(.+)/,"$1 WebView"],s],[/android.+samsungbrowser\/([\w\.]+)/i,/android.+version\/([\w\.]+)\s+(?:mobile\s?safari|safari)*/i],[s,[i,"Android Browser"]],[/(chrome|omniweb|arora|[tizenoka]{5}\s?browser)\/v?([\w\.]+)/i,/(qqbrowser)[\/\s]?([\w\.]+)/i],[i,s],[/(uc\s?browser)[\/\s]?([\w\.]+)/i,/ucweb.+(ucbrowser)[\/\s]?([\w\.]+)/i,/juc.+(ucweb)[\/\s]?([\w\.]+)/i],[[i,"UCBrowser"],s],[/(dolfin)\/([\w\.]+)/i],[[i,"Dolphin"],s],[/((?:android.+)crmo|crios)\/([\w\.]+)/i],[[i,"Chrome"],s],[/;fbav\/([\w\.]+);/i],[s,[i,"Facebook"]],[/fxios\/([\w\.-]+)/i],[s,[i,"Firefox"]],[/version\/([\w\.]+).+?mobile\/\w+\s(safari)/i],[s,[i,"Mobile Safari"]],[/version\/([\w\.]+).+?(mobile\s?safari|safari)/i],[s,i],[/webkit.+?(mobile\s?safari|safari)(\/[\w\.]+)/i],[i,[s,f.str,p.browser.oldsafari.version]],[/(konqueror)\/([\w\.]+)/i,/(webkit|khtml)\/([\w\.]+)/i],[i,s],[/(navigator|netscape)\/([\w\.-]+)/i],[[i,"Netscape"],s],[/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo\sbrowser|minimo|conkeror)[\/\s]?([\w\.\+]+)/i,/(firefox|seamonkey|k-meleon|icecat|iceape|firebird|phoenix)\/([\w\.-]+)/i,/(mozilla)\/([\w\.]+).+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir)[\/\s]?([\w\.]+)/i,/(links)\s\(([\w\.]+)/i,/(gobrowser)\/?([\w\.]+)*/i,/(ice\s?browser)\/v?([\w\._]+)/i,/(mosaic)[\/\s]([\w\.]+)/i],[i,s]],cpu:[[/(?:(amd|x(?:(?:86|64)[_-])?|wow|win)64)[;\)]/i],[["architecture","amd64"]],[/(ia32(?=;))/i],[["architecture",d.lowerize]],[/((?:i[346]|x)86)[;\)]/i],[["architecture","ia32"]],[/windows\s(ce|mobile);\sppc;/i],[["architecture","arm"]],[/((?:ppc|powerpc)(?:64)?)(?:\smac|;|\))/i],[["architecture",/ower/,"",d.lowerize]],[/(sun4\w)[;\)]/i],[["architecture","sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|arm(?:64|(?=v\d+;))|(?=atmel\s)avr|(?:irix|mips|sparc)(?:64)?(?=;)|pa-risc)/i],[["architecture",d.lowerize]]],device:[[/\((ipad|playbook);[\w\s\);-]+(rim|apple)/i],[r,u,[a,l]],[/applecoremedia\/[\w\.]+ \((ipad)/],[r,[u,"Apple"],[a,l]],[/(apple\s{0,1}tv)/i],[[r,"Apple TV"],[u,"Apple"]],[/(archos)\s(gamepad2?)/i,/(hp).+(touchpad)/i,/(hp).+(tablet)/i,/(kindle)\/([\w\.]+)/i,/\s(nook)[\w\s]+build\/(\w+)/i,/(dell)\s(strea[kpr\s\d]*[\dko])/i],[u,r,[a,l]],[/(kf[A-z]+)\sbuild\/[\w\.]+.*silk\//i],[r,[u,"Amazon"],[a,l]],[/(sd|kf)[0349hijorstuw]+\sbuild\/[\w\.]+.*silk\//i],[[r,f.str,p.device.amazon.model],[u,"Amazon"],[a,c]],[/\((ip[honed|\s\w*]+);.+(apple)/i],[r,u,[a,c]],[/\((ip[honed|\s\w*]+);/i],[r,[u,"Apple"],[a,c]],[/(blackberry)[\s-]?(\w+)/i,/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|huawei|meizu|motorola|polytron)[\s_-]?([\w-]+)*/i,/(hp)\s([\w\s]+\w)/i,/(asus)-?(\w+)/i],[u,r,[a,c]],[/\(bb10;\s(\w+)/i],[r,[u,"BlackBerry"],[a,c]],[/android.+(transfo[prime\s]{4,10}\s\w+|eeepc|slider\s\w+|nexus 7|padfone)/i],[r,[u,"Asus"],[a,l]],[/(sony)\s(tablet\s[ps])\sbuild\//i,/(sony)?(?:sgp.+)\sbuild\//i],[[u,"Sony"],[r,"Xperia Tablet"],[a,l]],[/(?:sony)?(?:(?:(?:c|d)\d{4})|(?:so[-l].+))\sbuild\//i],[[u,"Sony"],[r,"Xperia Phone"],[a,c]],[/\s(ouya)\s/i,/(nintendo)\s([wids3u]+)/i],[u,r,[a,"console"]],[/android.+;\s(shield)\sbuild/i],[r,[u,"Nvidia"],[a,"console"]],[/(playstation\s[34portablevi]+)/i],[r,[u,"Sony"],[a,"console"]],[/(sprint\s(\w+))/i],[[u,f.str,p.device.sprint.vendor],[r,f.str,p.device.sprint.model],[a,c]],[/(lenovo)\s?(S(?:5000|6000)+(?:[-][\w+]))/i],[u,r,[a,l]],[/(htc)[;_\s-]+([\w\s]+(?=\))|\w+)*/i,/(zte)-(\w+)*/i,/(alcatel|geeksphone|huawei|lenovo|nexian|panasonic|(?=;\s)sony)[_\s-]?([\w-]+)*/i],[u,[r,/_/g," "],[a,c]],[/(nexus\s9)/i],[r,[u,"HTC"],[a,l]],[/(nexus\s6p)/i],[r,[u,"Huawei"],[a,c]],[/(microsoft);\s(lumia[\s\w]+)/i],[u,r,[a,c]],[/[\s\(;](xbox(?:\sone)?)[\s\);]/i],[r,[u,"Microsoft"],[a,"console"]],[/(kin\.[onetw]{3})/i],[[r,/\./g," "],[u,"Microsoft"],[a,c]],[/\s(milestone|droid(?:[2-4x]|\s(?:bionic|x2|pro|razr))?(:?\s4g)?)[\w\s]+build\//i,/mot[\s-]?(\w+)*/i,/(XT\d{3,4}) build\//i,/(nexus\s6)/i],[r,[u,"Motorola"],[a,c]],[/android.+\s(mz60\d|xoom[\s2]{0,2})\sbuild\//i],[r,[u,"Motorola"],[a,l]],[/hbbtv\/\d+\.\d+\.\d+\s+\([\w\s]*;\s*(\w[^;]*);([^;]*)/i],[[u,d.trim],[r,d.trim],[a,"smarttv"]],[/hbbtv.+maple;(\d+)/i],[[r,/^/,"SmartTV"],[u,"Samsung"],[a,"smarttv"]],[/\(dtv[\);].+(aquos)/i],[r,[u,"Sharp"],[a,"smarttv"]],[/android.+((sch-i[89]0\d|shw-m380s|gt-p\d{4}|gt-n\d+|sgh-t8[56]9|nexus 10))/i,/((SM-T\w+))/i],[[u,"Samsung"],r,[a,l]],[/smart-tv.+(samsung)/i],[u,[a,"smarttv"],r],[/((s[cgp]h-\w+|gt-\w+|galaxy\snexus|sm-\w[\w\d]+))/i,/(sam[sung]*)[\s-]*(\w+-?[\w-]*)*/i,/sec-((sgh\w+))/i],[[u,"Samsung"],r,[a,c]],[/sie-(\w+)*/i],[r,[u,"Siemens"],[a,c]],[/(maemo|nokia).*(n900|lumia\s\d+)/i,/(nokia)[\s_-]?([\w-]+)*/i],[[u,"Nokia"],r,[a,c]],[/android\s3\.[\s\w;-]{10}(a\d{3})/i],[r,[u,"Acer"],[a,l]],[/android\s3\.[\s\w;-]{10}(lg?)-([06cv9]{3,4})/i],[[u,"LG"],r,[a,l]],[/(lg) netcast\.tv/i],[u,r,[a,"smarttv"]],[/(nexus\s[45])/i,/lg[e;\s\/-]+(\w+)*/i],[r,[u,"LG"],[a,c]],[/android.+(ideatab[a-z0-9\-\s]+)/i],[r,[u,"Lenovo"],[a,l]],[/linux;.+((jolla));/i],[u,r,[a,c]],[/((pebble))app\/[\d\.]+\s/i],[u,r,[a,"wearable"]],[/android.+;\s(glass)\s\d/i],[r,[u,"Google"],[a,"wearable"]],[/android.+(\w+)\s+build\/hm\1/i,/android.+(hm[\s\-_]*note?[\s_]*(?:\d\w)?)\s+build/i,/android.+(mi[\s\-_]*(?:one|one[\s_]plus|note lte)?[\s_]*(?:\d\w)?)\s+build/i],[[r,/_/g," "],[u,"Xiaomi"],[a,c]],[/android.+a000(1)\s+build/i],[r,[u,"OnePlus"],[a,c]],[/\s(tablet)[;\/]/i,/\s(mobile)(?:[;\/]|\ssafari)/i],[[a,d.lowerize],u,r]],engine:[[/windows.+\sedge\/([\w\.]+)/i],[s,[i,"EdgeHTML"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m)\/([\w\.]+)/i,/(khtml|tasman|links)[\/\s]\(?([\w\.]+)/i,/(icab)[\/\s]([23]\.[\d\.]+)/i],[i,s],[/rv\:([\w\.]+).*(gecko)/i],[s,i]],os:[[/microsoft\s(windows)\s(vista|xp)/i],[i,s],[/(windows)\snt\s6\.2;\s(arm)/i,/(windows\sphone(?:\sos)*)[\s\/]?([\d\.\s]+\w)*/i,/(windows\smobile|windows)[\s\/]?([ntce\d\.\s]+\w)/i],[i,[s,f.str,p.os.windows.version]],[/(win(?=3|9|n)|win\s9x\s)([nt\d\.]+)/i],[[i,"Windows"],[s,f.str,p.os.windows.version]],[/\((bb)(10);/i],[[i,"BlackBerry"],s],[/(blackberry)\w*\/?([\w\.]+)*/i,/(tizen)[\/\s]([\w\.]+)/i,/(android|webos|palm\sos|qnx|bada|rim\stablet\sos|meego|contiki)[\/\s-]?([\w\.]+)*/i,/linux;.+(sailfish);/i],[i,s],[/(symbian\s?os|symbos|s60(?=;))[\/\s-]?([\w\.]+)*/i],[[i,"Symbian"],s],[/\((series40);/i],[i],[/mozilla.+\(mobile;.+gecko.+firefox/i],[[i,"Firefox OS"],s],[/(nintendo|playstation)\s([wids34portablevu]+)/i,/(mint)[\/\s\(]?(\w+)*/i,/(mageia|vectorlinux)[;\s]/i,/(joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|(?=\s)arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk|linpus)[\/\s-]?(?!chrom)([\w\.-]+)*/i,/(hurd|linux)\s?([\w\.]+)*/i,/(gnu)\s?([\w\.]+)*/i],[i,s],[/(cros)\s[\w]+\s([\w\.]+\w)/i],[[i,"Chromium OS"],s],[/(sunos)\s?([\w\.]+\d)*/i],[[i,"Solaris"],s],[/\s([frentopc-]{0,4}bsd|dragonfly)\s?([\w\.]+)*/i],[i,s],[/(haiku)\s(\w+)/i],[i,s],[/(ip[honead]+)(?:.*os\s([\w]+)*\slike\smac|;\sopera)/i],[[i,"iOS"],[s,/_/g,"."]],[/(mac\sos\sx)\s?([\w\s\.]+\w)*/i,/(macintosh|mac(?=_powerpc)\s)/i],[[i,"Mac OS"],[s,/_/g,"."]],[/((?:open)?solaris)[\/\s-]?([\w\.]+)*/i,/(aix)\s((\d)(?=\.|\)|\s)[\w\.]*)*/i,/(plan\s9|minix|beos|os\/2|amigaos|morphos|risc\sos|openvms)/i,/(unix)\s?([\w\.]+)*/i],[i,s]]},g=function(n,t){if(!(this instanceof g))return new g(n,t).getResult();var o=n||(e&&e.navigator&&e.navigator.userAgent?e.navigator.userAgent:""),r=t?d.extend(m,t):m;return this.getBrowser=function(){var e=f.rgx.apply(this,r.browser);return e.major=d.major(e.version),e},this.getCPU=function(){return f.rgx.apply(this,r.cpu)},this.getDevice=function(){return f.rgx.apply(this,r.device)},this.getEngine=function(){return f.rgx.apply(this,r.engine)},this.getOS=function(){return f.rgx.apply(this,r.os)},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return o},this.setUA=function(e){return o=e,this},this};g.VERSION="0.7.12",g.BROWSER={NAME:i,MAJOR:"major",VERSION:s},g.CPU={ARCHITECTURE:"architecture"},g.DEVICE={MODEL:r,VENDOR:u,TYPE:a,CONSOLE:"console",MOBILE:c,SMARTTV:"smarttv",TABLET:l,WEARABLE:"wearable",EMBEDDED:"embedded"},g.ENGINE={NAME:i,VERSION:s},g.OS={NAME:i,VERSION:s},void 0!==t?(void 0!==n&&n.exports&&(t=n.exports=g),t.UAParser=g):"function"==typeof define&&define.amd?define(function(){return g}):e.UAParser=g;var b=e.jQuery||e.Zepto;if(void 0!==b){var y=new g;b.ua=y.getResult(),b.ua.get=function(){return y.getUA()},b.ua.set=function(e){y.setUA(e);var n=y.getResult();for(var t in n)b.ua[t]=n[t]}}}("object"==typeof window?window:this)},{}],3:[function(e,n,t){(function(n){"use strict";function o(e,n){return a(e)||i(e,n)||r()}function r(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function i(e,n){var t=[],o=!0,r=!1,i=void 0;try{for(var a,u=e[Symbol.iterator]();!(o=(a=u.next()).done)&&(t.push(a.value),!n||t.length!==n);o=!0);}catch(e){r=!0,i=e}finally{try{o||null==u.return||u.return()}finally{if(r)throw i}}return t}function a(e){if(Array.isArray(e))return e}var u,s,c="undefined"!=typeof window?window.Bacon:void 0!==n?n.Bacon:null,l=e("./storage"),d=e("auth"),f=e("browser"),p=e("./url-resolver"),m=e("./registration"),g=m.signUp,b=m.signIn,y=m.signOut,w=e("./update"),v=e("./language"),h=v.messages;t.device=u=c.fromPromise(l.read("device")).skipErrors().merge(g.merge(b).merge(w).map(function(e){return e.device})).filter(function(e){return e}).scan({},function(e,n){for(var t in n){var o=n[t];e[t]=o}return e}).changes().merge(y.map(null)).toProperty(null),u.filter(function(e){return e}).onValue(function(e){l.write("device",e),d.setCredentials(e.token,e.tokenSecret)}),t.user=s=c.fromPromise(l.read("user")).skipErrors().merge(g.merge(b).merge(w).map(function(e){return e.user})).filter(function(e){return e}).merge(y.map(null)).toProperty(null),s.filter(function(e){return e}).onValue(function(e){return l.write("user",e)}),y.onValue(function(){l.write("default_location",!1),l.delete("default_location"),l.delete("user"),l.delete("device")});var _=s.slidingWindow(2,2).filter(function(e){var n=o(e,2),t=n[0],r=n[1];return t&&r&&t.hasOwnProperty("is_premium")&&r.hasOwnProperty("is_premium")&&t.hasOwnProperty("id")&&r.hasOwnProperty("id")}).filter(function(e){var n=o(e,2),t=n[0],r=n[1];return t.is_premium!==r.is_premium&&t.id===r.id}).map(function(e){var n=o(e,2);n[0];return n[1].is_premium});t.premiumChanges=_,_.flatMap(function(e){return c.combineAsArray(u.take(1),h.take(1),e,s)}).map(function(n){var t=o(n,4),r=(t[0],t[1]),i=t[2],a=(t[3],r.notifications.status_change);if(i)return[a.upgraded_title,a.upgraded_msg,null];p=e("./url-resolver");var u=p("account/premium",{utm_medium:"crm",utm_source:"extension-notification",utm_campaign:"premium-promotion"});return[a.downgraded_title,a.downgraded_msg,u]}).onValues(function(e,n,t){var o={type:"basic",title:e,message:n},r={title:e,text:n,data:{url:t}};return f.notify({chrome:{newsItem:o,data:{url:t}},firefox:r})})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./language":36,"./registration":54,"./storage":56,"./update":60,"./url-resolver":61,auth:5,browser:8}],4:[function(e,n,t){(function(t){"use strict";function o(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},o=Object.keys(t);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(t).filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),o.forEach(function(n){r(e,n,t[n])})}return e}function r(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function i(e,n){return s(e)||u(e,n)||a()}function a(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function u(e,n){var t=[],o=!0,r=!1,i=void 0;try{for(var a,u=e[Symbol.iterator]();!(o=(a=u.next()).done)&&(t.push(a.value),!n||t.length!==n);o=!0);}catch(e){r=!0,i=e}finally{try{o||null==u.return||u.return()}finally{if(r)throw i}}return t}function s(e){if(Array.isArray(e))return e}function c(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"GET",t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return d.retry({source:function(){return d.fromPromise(p({url:"".concat(h.get().apiURL).concat(o.skipV2?"/":"/v2/").concat(e),responseType:"json",method:n,data:t,headers:{"x-rm-url":h.get().apiURLs[0]}})).flatMapError(function(e){return d.combineAsArray([e,g]).flatMap(function(e){var n=i(e,2),t=n[0],o=n[1];return v({error:t,stickyFrontingDomain:o}).flatMap(function(e){return d.once(new d.Error(e))})})})},retries:2,isRetryable:function(e){var n=e.error;return!!e.online&&(e.frontingDomain?b(e.frontingDomain):e.apiUrl&&h.setApiURL(e.apiUrl),!n||403!==n.status)},delay:function(){return 250}}).map(function(e){return e.payload})}function l(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"GET",t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return d.fromPromise(y.read("device")).skipErrors().flatMapLatest(function(r){return c(e,n,o({},t,{auth_method:"device",auth_id:r.token,auth_secret:r.tokenSecret}))})}var d="undefined"!=typeof window?window.Bacon:void 0!==t?t.Bacon:null,f=e("./xhr"),p=f.request,m=e("fronting"),g=m.stickyFrontDomain,b=m.enableFullFronting,y=e("./storage"),w=e("./connectivity"),v=w.connectivityCheck,h=e("./config");n.exports={apiRequest:c,apiRequestWithAuth:l}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./config":9,"./connectivity":11,"./storage":56,"./xhr":68,fronting:30}],5:[function(e,n,t){"use strict";var o=(e("loglevel"),"no_data_in_plugin"),r="no_data_in_plugin",i="";t.setCredentials=function(e,n){o=e,r=n},t.setFeatureFlags=function(e){i=e},t.authHandler=function(e,n){if(!e.isProxy||!e.realm.toLowerCase().includes("zenmate"))return n?n():Promise.resolve();var t=o;i&&(t+=";".concat(i));var a={authCredentials:{username:t,password:r}};return n?n(a):Promise.resolve(a)}},{loglevel:1}],6:[function(e,n,t){(function(n){"use strict";var o="undefined"!=typeof window?window.Bacon:void 0!==n?n.Bacon:null,r=(e("loglevel"),e("./util")),i=o.fromBinder(function(e){if(r.isChrome)return chrome.management.onEnabled.addListener(e),chrome.management.onDisabled.addListener(e),chrome.proxy.settings.onChange.addListener(e)}).flatMapLatest(function(){return a()}),a=function(){return o.fromCallback(function(e){if(r.isChrome)return chrome.proxy.settings.get({incognito:!1},e)})};t.proxyBlocked=a().merge(i).map(function(e){return!["controllable_by_this_extension","controlled_by_this_extension"].includes(e&&e.levelOfControl)}).toProperty(!1),t.proxyBlockedBy=t.proxyBlocked.flatMapLatest(function(e){return o.fromCallback(function(n){return e?chrome.management.getAll(function(e){var t=e.filter(function(e){return chrome.runtime.id!==e.id&&e.enabled&&e.permissions.includes("proxy")}).map(function(e){return{id:e.id,name:e.name,icon:e.icons&&e.icons[0].url}});return n(t)}):n([])})}).toProperty()}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./util":62,loglevel:1}],7:[function(e,n,t){(function(t){"use strict";var o="undefined"!=typeof window?window.Bacon:void 0!==t?t.Bacon:null,r=e("browser"),i=e("./tab-info"),a=e("./config"),u=e("./language"),s=u.messages,c=i.filter(function(e){return!!a.get().blockedSites.includes(e.host)&&(r.closePage(e.url),!0)}).map(function(e){return e.url});o.combineAsArray(c,s).onValues(function(e,n){var t=n.notifications.blocked_site.title,o=n.notifications.blocked_site.message.replace("{blockedURL}",e),i={type:"basic",title:t,message:o},a={title:t,text:o,data:{}};return r.notify({chrome:{newsItem:i,data:{}},firefox:a})}),n.exports=c}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./config":9,"./language":36,"./tab-info":57,browser:8}],8:[function(e,n,t){(function(n){"use strict";function o(e){return a(e)||i(e)||r()}function r(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function i(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function a(e){if(Array.isArray(e)){for(var n=0,t=new Array(e.length);n<e.length;n++)t[n]=e[n];return t}}function u(e,n){return l(e)||c(e,n)||s()}function s(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function c(e,n){var t=[],o=!0,r=!1,i=void 0;try{for(var a,u=e[Symbol.iterator]();!(o=(a=u.next()).done)&&(t.push(a.value),!n||t.length!==n);o=!0);}catch(e){r=!0,i=e}finally{try{o||null==u.return||u.return()}finally{if(r)throw i}}return t}function l(e){if(Array.isArray(e))return e}var d,f,p,m,g,b="undefined"!=typeof window?window.Bacon:void 0!==n?n.Bacon:null,y=e("loglevel"),w=e("./api_request"),v=w.apiRequest,h=e("./fronting"),_=h.enableFronting,L=e("./storage"),x=e("./url-resolver"),k=e("./auth"),E=k.authHandler,I=e("./util"),P=e("./config"),S=e("./pacengine"),A=e("ua-parser-js"),C=e("./tab_state"),O=C.tabState,j=e("./locations"),R=e("./tab-info");b.combineAsArray(O,j,R).onValue(function(e){var n=u(e,3),t=n[0],o=n[1],r=n[2];if(!I.isChrome&&m&&t.isRuleActive){var i=o.find(function(e){return e.country_code===t.customCountry}),a=i.nodes[0],s=a.split(":"),c=u(s,2),l=c[0],d=c[1];p={type:"https",host:l,port:Number(d)||443},L.read("tab_rule_"+r.id).then(function(e){e!==t.customCountry&&L.write("tab_rule_"+r.id,t.customCountry).then(function(){chrome.tabs.reload(r.id)})}).catch(function(){L.write("tab_rule_"+r.id,t.customCountry).then(function(){chrome.tabs.reload(r.id)})})}else if(!I.isChrome){var f=g.split(":"),b=u(f,2),y=b[0],w=b[1];p={type:"https",host:y,port:Number(w)||443}}}),e("./page_api");var T=new A(navigator.userAgent).getResult();p={type:"direct",host:null,port:null},m=!1,t.getName=function(){return T.browser.name},t.getInstallSource=function(e){var n=[{name:"website",pattern:"*://zenmate.com/*",host:"zenmate.com/"},{name:"chromestore",pattern:"*://chrome.google.com/webstore/detail/*/".concat(chrome.runtime.id,"*"),host:"chrome.google.com/"},{name:"operastore",pattern:"*://addons.opera.com/*/extensions/details/zenmate-for-operatm/*",host:"addons.opera.com/"}];try{chrome.tabs.query({url:n.map(function(e){return e.pattern})},function(t){var o=!0,r=!1,i=void 0;try{for(var a,u=t[Symbol.iterator]();!(o=(a=u.next()).done);o=!0)for(var s=a.value,c=I.getUTMSourcesFromURL(s.url),l=0;l<n.length;l++){var d=n[l];if(s.url.indexOf(d.host)>-1)return e("url=".concat(d.name,";").concat(c))}}catch(e){r=!0,i=e}finally{try{o||null==u.return||u.return()}finally{if(r)throw i}}return e("unknown")})}catch(n){return y.error(n),e("unknown")}};var F=function(e){return d("page.html")},D=function(e){return e.login="y",F()};t.openSignupPage=function(){return t.getInstallSource(function(e){if(e.includes(";")){e=e.split(";")[0].split("=")[1]}var n={utm_medium:"product",utm_source:"extension-tabspawn",utm_content:"onboarding"};return L.read("signup_shown").then(function(){return t.openPage(D(n))}).catch(function(){return L.write("signup_shown",!0),t.openPage(F())})})},t.openPage=f=function(e){return chrome.tabs.create({url:e,active:!0},function(e){return chrome.windows.update(e.windowId,{focused:!0})})},t.openPopup=function(e,n){return chrome.windows.create({type:"popup",url:e,width:1024,top:0,height:700},n)},t.closePage=function(e,n){return chrome.tabs.query({url:e},function(e){if(e)return e.filter(function(e){return e.id!==n}).map(function(e){return chrome.tabs.remove(e.id)})})},t.getExtensionURL=d=function(e){return chrome.extension.getURL(e)},t.setIconAction=function(e){return"popup"===e?chrome.browserAction.setPopup({popup:"popup.html"}):chrome.browserAction.setPopup({popup:""})},chrome&&(chrome.browserAction.onClicked.addListener(function(){return t.openSignupPage()}),chrome.runtime.onInstalled.addListener(function(e){if("update"===e.reason)return v("et/upgrade","GET",{previous_version:e.previousVersion}).onValue()}));if(t.setup=function(){return chrome.runtime.onUpdateAvailable.addListener(function(){return chrome.runtime.reload()}),chrome.runtime.setUninstallURL(x("account/uninstall",{utm_medium:"product",utm_source:"extension-tabspawn",utm_content:"uninstall-feedback"})),chrome.webRequest.onBeforeSendHeaders.addListener(function(e){return{cancel:!0}},{urls:["*://www.google.com/searchdomaincheck*"]},["blocking"]),_().then(function(){return L.read("device").then(function(e){return!(!e.uuid||!e.token)}).catch(function(){return!1})})},t.hasIncognitoAccess=function(e){return chrome.extension.isAllowedIncognitoAccess(function(n){return e(n)})},!I.isChrome);t.connect=function(e,n,t,r,i,a){var s=S.getNodeDictFromLocations(n,P.get().alternativeNodes);if(m=i,I.isChrome){if(i){var c=S.exportPAC(e.country_code,s,t,r),l={value:{mode:"pac_script",pacScript:{data:c}},scope:"regular"};chrome.proxy.settings.set(l,function(e){})}else{var d=e.nodes[0],f=d.split(":"),b=u(f,2),y=b[0],w=b[1],v={value:{mode:"fixed_servers",rules:{singleProxy:{scheme:"https",host:y,port:Number(w)||443},bypassList:o(r).concat(o(P.get().localDomains),o(P.get().privateNetworks))}},scope:"regular"};chrome.proxy.settings.set(v,function(e){})}L.read("device").then(function(e){var n=3;chrome.webRequest.onAuthRequired.addListener(function(t,o){if(--n<0)return{cancel:!0};o({authCredentials:{username:e.token,password:e.tokenSecret}})},{urls:["<all_urls>"]},["asyncBlocking"])})}else{var h=e.nodes[0],_=h.split(":"),x=u(_,2),k=x[0],E=x[1];g=h,p={type:"https",host:k,port:Number(E)||443},browser.proxy.onRequest.addListener(U,{urls:["<all_urls>"]}),browser.proxy.onError.addListener(function(e){}),L.read("device").then(function(e){var n=3;browser.webRequest.onAuthRequired.addListener(function(t,o){if(--n<0)return{cancel:!0};o({authCredentials:{username:e.token,password:e.tokenSecret}})},{urls:["<all_urls>"]},["blocking"])})}};var B=function(e){return-1!=e.parentFrameId},U=function(e){return B(e),p};t.disconnect=function(){I.isChrome?(chrome.proxy.settings.set({value:{mode:"direct"},scope:"regular"},function(e){}),chrome.webRequest.onAuthRequired.removeListener(E)):(p={type:"direct",host:null,port:null},browser.proxy.onRequest.removeListener(U),browser.webRequest.onAuthRequired.removeListener(E))};var W={signedout:{38:d("icons/standard-38.png"),19:d("icons/standard-19.png")},enabled:{38:d("icons/enabled-38.png"),19:d("icons/enabled-19.png")},disabled:{38:d("icons/disabled-38.png"),19:d("icons/disabled-19.png")}};t.setIconImage=function(e,n){var t={path:W[e.toLowerCase()]};return n&&(t.tabId=n),chrome.browserAction.setIcon(t)},t.setIconTitle=function(e,n){var t={title:"ZenMate"};return e&&(t.title="".concat(t.title,"\n").concat(e)),chrome.browserAction.setTitle(t)},t.setIconBadge=function(e,n,t){t||(t="#008ace"),chrome.browserAction.setBadgeBackgroundColor({color:t}),chrome.browserAction.setBadgeText({text:e||"",tabId:n},function(e){chrome.runtime.lastError})};var N={},M={},Y=null;t.notificationEvents=b.fromBinder(function(e){return Y=e});var V=function(e,n){var t;if(chrome.notifications.clear(e),t="number"==typeof n?N[e]&&N[e][n]&&N[e][n].url:M[e]){if(t.startsWith("http"))return f(t,!1);if(t.startsWith("event"))return Y({event:t.replace("event://",""),notificationId:e})}};chrome.notifications.onClicked.addListener(V),chrome.notifications.onButtonClicked&&chrome.notifications.onButtonClicked.addListener(V),t.notify=function(e){var n=e.chrome.newsItem,t=e.chrome.data;n.iconUrl=d("images/notification_chrome@2x.png"),n.eventTime=Date.now(),n.title=n.title||chrome.runtime.getManifest().name,n.isClickable=!(!t||!t.url);var o=I.hashString(t&&t.id||e);return t&&t.actions&&(n.buttons=t.actions.map(function(e){return{title:e.text}}),N[o]=t.actions),t&&t.url&&(M[o]=t.url),chrome.notifications.create(o,n,function(e){})},t.fullReset=function(){},t.getLocale=function(){return navigator.language.toString().toLowerCase().split("-")[0]||"en"},t.getVersion=function(){return chrome.runtime.getManifest().version}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./api_request":4,"./auth":5,"./config":9,"./fronting":30,"./locations":40,"./pacengine":47,"./page_api":49,"./storage":56,"./tab-info":57,"./tab_state":58,"./url-resolver":61,"./util":62,loglevel:1,"ua-parser-js":2}],9:[function(e,n,t){"use strict";function o(e){e&&(l.logLevel=e,c.setLevel(l.logLevel),console.info("logLevel:",l.logLevel))}function r(e){e&&(l.apiURL=e,console.info("api:",l.apiURL))}function i(e){e&&(l.cgApiURL=e,console.info("cg api:",l.cgApiURL))}function a(e){e&&(l.newsServiceUrl=e,console.info("newsServiceUrl:",l.newsServiceUrl))}function u(e){e&&(l.authApiDomain=e,console.info("authApiDomain:",l.authApiDomain))}function s(e){e&&(l.dfsURL=e,console.info("dfsURL:",l.dfsURL))}var c=e("loglevel"),l={logLevel:"silent",apiURL:"https://api.zcdn.de",apiURLs:["https://api.zcdn.de"],apiFront:"d1mvkhn4psrs16.cloudfront.net",cgApiURL:"https://apiv2.zenguard.biz",cgApiURLs:["https://apiv2.zenguard.biz","https://apiv1.zenguard.biz/cg"],cgApiURLsFronting:["https://apiv2.zenguard.biz"],cgAppKey:"NaTcDzdioTXdvKgbUDAXIQRoM6nFZSpedg9S",geoRedirector:"https://geo.zenmate.com",accountRedirector:"https://account.zenmate.com",websiteFront:"d21e7xkr9vlo60.cloudfront.net",websiteAssets:"du3rt6yhb1dqh.cloudfront.net",criticalWebsiteDomains:["zenmate.com"],websiteDomains:["zenmate.com"],ipApi:"https://ip-info.zenmate.com",
domainFronts:"WyIxMDEubGl2ZXJlLmNvLmtyIiwiMnUuY29tIiwiYTAuYXdzc3RhdGljLmNvbSIsImFicmFrYW0uY29tIiwiYWRtaW4uYWJlbWFmcmVzaC50diIsImFkbWluLmFnaWxpeGJ1enouY29tIiwiYWRtaW4uYWlybWFwLmNvbSIsImFkbWluLmFsbGVnby5jb20iLCJhZG1pbi5hc3NpZ25hci5jb20uYXUiLCJhZG1pbi5iZWFjaGJvZHlnbG9iYWwuY29tIiwiYWRtaW4uYmVlcHNlbmQuY29tIiwiYWRtaW4uYnJpZGcuY29tIiwiYWRtaW4uYnVybmVyYXBwLmNvbSIsImFkbWluLmNhdXNlbHkuY29tIiwiYWRtaW4uY2xhc3M0a2lkcy5jby51ayIsImFkbWluLmRhaG1ha2FuLmNvbSIsImFkbWluLmVjaG8tbnRuLm9yZyIsImFkbWluLmVkY2FzdC5jb20iLCJhZG1pbi5lbGVjdGlvbnJ1bm5lci5jb20iLCJhZG1pbi5lbGV2YXRlbWFwcy5pbyIsImFkbWluLmV2ZW5maW5hbmNpYWwuY29tIiwiYWRtaW4uZmFjdWx0eWRpdmVyc2l0eS5vcmciLCJhZG1pbi5mb29kdGlkaW5ncy5jb20iLCJhZG1pbi5mdXplLm1lIiwiYWRtaW4uZ29pbnRlZ3JvLmNvbSIsImFkbWluLmd1aW5uZXNzLXN0b3JlaG91c2UuY29tIiwiYWRtaW4uaGFiaS1kby5jb20iLCJhZG1pbi5oYW5jb2Nrd2hpdG5leS5jb20iLCJhZG1pbi5qZWJiaXQuY29tIiwiYWRtaW4ua2V5d29yZHBsYW5uZXIucHJvIiwiYWRtaW4ubGF1bmNoMjcuY29tIiwiYWRtaW4ubGF3bnN0YXJ0ZXIuY29tIiwiYWRtaW4ubGVuZG9wb2xpcy5jb20iLCJhZG1pbi5saXF1aWRibG94LmNvbSIsImFkbWluLmxpdG11c2Nkbi5jb20iLCJhZG1pbi5sb2FuaGVyby5jb20iLCJhZG1pbi5tYWlsY2hhcnRzLmNvbSIsImFkbWluLm15aHViaW50cmFuZXQuY29tIiwiYWRtaW4ubnV0cmlzbGljZS5jb20iLCJhZG1pbi5wYXRoYWJsZS5jb20iLCJhZG1pbi5wbGFuZXQuY29tIiwiYWRtaW4ucHJpbnRtb3Rvci5jb20iLCJhZG1pbi5wcmlzdGluZS5pbyIsImFkbWluLnB1bHpvLmNvbSIsImFkbWluLnJlbWVyZ2UuaW8iLCJhaXJuZXd6ZWFsYW5kLmNvLm56IiwiYWlydmlzdGFyYS5jb20iLCJhbGRpLmRlIiwiYW1pcmVudHN0YWJpbGl6ZWQuY29tIiwiYW5zd2VyYmFja21hY2hpbmUub3JnIiwiYXNpYXdlYmRpcmVjdC5jb20iLCJhd3MtYmxvZy5pbyIsImJldGhlc2RhLm5ldCIsImJldGhlc2lnbmFsLm9yZyIsImJpei1qb3VybmFsLmpwIiwiYm9tYm9yYXRlY2guY29tLmF1IiwiYnJ5Y2UuZmlzaGVyLWZsZWlnLm9yZyIsImNhbWZyb2cuY29tIiwiY2RuLWltYWdlcy5tYWlsY2hpbXAuY29tIiwiY2RuLmRpc3BsYXlzMmdvLmNvbSIsImNkbi5lcmluY2FsbC5jb20iLCJjZG4uZ2xvYmFsaGVhbGluZ2NlbnRlci5jb20iLCJjZi5kcm9wYm94cGF5bWVudHMuY29tIiwiY2hyb25pY2xlLmNvbSIsImNsYXNob2ZjbGFucy5jb20iLCJjbGllbnR1cGRhdGVzLmRyb3Bib3hzdGF0aWMuY29tIiwiY2xpbWF0ZS5jb20iLCJjbG91ZHBhY2subWVkaWEiLCJjb2RlLm9yZyIsImNvbm5lY3Rpdml0eS5hbWF6b253b3Jrc3BhY2VzLmNvbSIsImNvdXJzZXJhLm9yZyIsImQwLmF3c3N0YXRpYy5jb20iLCJkYXZlcGVjay5vcmciLCJkZXZidWlsZHMudWJlci5jb20iLCJkZXZpYW50YXJ0LmNvbSIsImRldnJlbC5qcCIsImRvd25sb2FkLmVuZ2VsbWFubi5jb20iLCJkb3dubG9hZC5lcGljZ2FtZXMuY29tIiwiZWR1Y2F0aW9ucGVyZmVjdC5jb20iLCJmYW5jcmVkLm9yZyIsImZpZmFjb25uZWN0Lm9yZyIsImZpdGJpdC5jb20iLCJoYnIub3JnIiwiaGJzcC5oYXJ2YXJkLmVkdSIsImhzLmZpIiwiaHNjdS5uZXQiLCJodWItb2xvZ3kub3JnIiwiaWZsaXguY29tIiwiaW1hZ2VzLW5hLnNzbC1pbWFnZXMtYW1hem9uLmNvbSIsImluZm9qb2JzLm5ldCIsImphbWVzdHVyay5uZXQiLCJqdGNsYXJrLmNhIiwianVsaWVuLnBvbmdlLm9yZyIsImp1bXBzZWxsZXIuY29tLmJyIiwia2lja3N0YXJ0ZXIuY29tIiwibGl0ZS1yYS5jb20iLCJtZXJjYXJpLmNvbSIsIm1pbmVjcmFmdC5uZXQiLCJtaXRtcHJveHkub3JnIiwibXh0b29sYm94LmNvbSIsIm51YmFuay5jb20uYnIiLCJvYzcub3JnIiwib2xhY2Ficy5jb20iLCJwbGF0Zm9ybS5zaCIsInF1aXp1cC5jb20iLCJyYXpvcnNxbC5jb20iLCJyb3Zlci5jb20iLCJzaGFyZS5vcmlnaW4uOWNkbi5uZXQiLCJzaWduYWwuaXMiLCJzbWFsbHBkZi5jb20iLCJzcG9yemEuYmUiLCJzdGF0aWMuYmVpbnNwb3J0c2Nvbm5lY3QuZXMiLCJzdGF0aWMudW5lLmVkdS5hdSIsInVtdWMuZWR1IiwidmVyc2FuZC1zdGF0dXMuZGUiLCJ2b3RlLmdvdiIsIndkYy5jb20iLCJ3b3dhaXIuaXMiLCJ3d3cuYXBwZHluYW1pY3MuY29tIiwid3d3LmFwdGx5LmluZm8iLCJ3d3cuYmFua29mbWVsYm91cm5lLmNvbS5hdSIsInd3dy5ib3NlLmNvbSIsInd3dy5jbWNtLmNvbSIsInd3dy5pa3VzYWxpYy5jb20iLCJ3d3cuaWx0YXNhbm9tYXQuZmkiLCJ3d3cubHBnYS5vci5qcCIsInd3dy5vbHltcHVzLmNvbS50ciIsInd3dy5wYXlwYWwtZHluYW1pYy5jb20iLCJ3d3cucGViYmxlLmNvbSIsInd3dy5yb2t1LmNvbSIsInd3dy5zaGFzc28uY29tIiwid3d3LnNvZmluYS5jb20iLCJ3d3cuc3RlZWxvcmJpcy5jb20udHIiLCJ3d3cuc3RnZW9yZ2UuY29tLmF1Iiwid3d3LnRoZW1vdmllZGIub3JnIiwid3d3LnRydWxpYS5jb20iLCJ3d3cudHJ1c3RwaWxvdC5jb20iLCJ3d3cudW5yb2xsLm1lIiwid3d3LnV0b3JvbnRvLmNhIiwid3d3LndpbG1hYS5jb20iLCJ3d3cuemVuZWZpdHMuY29tIiwid3d3Lnp5eGVsLmNvbSIsInljb21iaW5hdG9yLmNvbSJd",authApiDomain:"auth.zenmate.com",authApiDomains:["auth.zenmate.com"],newsServiceUrl:"https://crm.zenguard.biz",newsServiceUrls:["https://crm.zenguard.biz"],newsServiceFront:"d3h6bpau3gi7cm.cloudfront.net",dfsURL:"https://dfs.zenmate.com",dfsURLs:["https://dfs.zenmate.com"],dfsFront:"d2106dcf23irrl.cloudfront.net",connectionCheckDomains:[{url:"http://www.google.com.sg/gen_204",code:204},{url:"http://g.cn/generate_204",code:204},{url:"http://www.thinkdifferent.us",code:200},{url:"http://www.airport.us",code:200},{url:"http://detectportal.firefox.com/success.txt",code:200},{url:"http://captive.apple.com",code:200}],localDomains:["zenguard.biz","*.zenguard.biz","zcdn.de","*.zcdn.de","zeus.pm","*.zeus.pm","d1jr1idae5ms9n.cloudfront.net","local","ip","fritz.box","kabel.box","invalid","intra","intranet","test","example","localhost","onion","i2p","lvh.me","vcap.me","127.0.0.1.xip.io","localtest.me","about:addons","about:newtab","about:preferences","about:config","about:debugging"],blackList:{"jid1-4P0kohSJxU1qGg@jetpack":"hola"},alternativeNodes:[],nodeOverrides:[],ruleOverrides:[{domains:["facebook.com"],hosts:["facebook.net","fbcdn.com","fbcdn.net","fbsbx.com","fb.me","fb.com","fbsbx.com.online-metrix.net","fbstatic-a.akamaihd.net","fbcdn-dragon-a.akamaihd.net"]},{domains:["netflix.com"],hosts:["nflxvideo.net"]},{domains:["bbc.co.uk","bbc.com"],hosts:["bbc.co.uk","bbc.com","vod-dash-uk-live.akamaized.net","vod-thumb-uk-live.akamaized.net"]},{domains:["speedtest.net"],hosts:["ooklaserver.net"]},{domains:["speedtest.xfinity.com"],hosts:["comcast.net"]}],blockedSites:["appnord.xyz"],privateNetworks:["0.0.0.0/8","10.0.0.0/8","127.0.0.0/8","169.254.0.0/16","192.168.0.0/16","172.16.0.0/12","::1","localhost","*.local"]};o("silent"),"undefined"!=typeof window&&(window.config=l),n.exports={get:function(){return l},setLogLevel:o,setApiURL:r,setCGApiURL:i,setNewsServiceUrl:a,setAuthApiDomain:u,setDfsUrl:s}},{loglevel:1}],10:[function(e,n,t){(function(t){"use strict";var o="undefined"!=typeof window?window.Bacon:void 0!==t?t.Bacon:null,r=e("browser"),i=e("./logged-in"),a=e("./enabled"),u=e("./rules"),s=u.rules,c=u.rulesEnabled,l=e("blocked"),d=l.proxyBlocked,f=e("./locations"),p=e("./locations/default"),m=e("./locations/streaming"),g=(e("loglevel"),e("./page_excludes")),b=e("./util"),y=b.shuffle,w=e("./proxy-error"),v=e("./webrtc"),h=v.webrtcProxyEnabled,_=e("./webrtc/controls"),L=_.clearWebrtcConfig,x=_.disableNonProxiedUDP,k=function(){return L(),r.disconnect()};n.exports=o.combineAsArray(i.and(d.not()).skipDuplicates(),a,p,f,m,s,c,g,h,w).onValues(function(e,n,t,o,i,a,u,s,c){if(!e)return k();var l=u&&a.length>0;return t.nodes&&y(t.nodes),l&&!n&&(t={country_code:"DEFAULT"}),l||(a=[]),n||l?(c?x():L(),r.connect(t,o,a,s,l,i)):k()})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./enabled":28,"./locations":40,"./locations/default":38,"./locations/streaming":41,"./logged-in":42,"./page_excludes":50,"./proxy-error":53,"./rules":55,"./util":62,"./webrtc":64,"./webrtc/controls":63,blocked:6,browser:8,loglevel:1}],11:[function(e,n,t){(function(n){"use strict";var o="undefined"!=typeof window?window.Bacon:void 0!==n?n.Bacon:null,r=e("xhr"),i=(r.request,e("./util")),a=i.shuffle,u=i.chunk,s=e("config"),c=e("./fronting_domains");t.checkConnection=function(){return o.once(!0)},t.checkPing=function(e){return t.checkConnection("".concat(e,"/ping"),200,"HEAD",{"x-rm-url":s.get().apiURLs[0]})},t.websiteConnectionCheck=function(){return o.fromArray(s.get().criticalWebsiteDomains).flatMap(function(e){return t.checkConnection("https://".concat(e,"/robots.txt"),200)}).reduce(!0,function(e,n){return e&&n})},t.apiConnectionCheck=function(){return o.fromArray(s.get().apiURLs).flatMap(function(e){return t.checkPing(e).map(function(n){return n?e:null})}).reduce(null,function(e,n){return e||n})},t.cgApiConnectionCheck=function(){return o.fromArray(s.get().cgApiURLsFronting).flatMap(function(e){return t.checkConnection("".concat(e,"/ping"),200).map(function(n){return n?e:null})}).reduce(null,function(e,n){return e||n})},t.apiFrontingCheck=function(e){var n=!0;return t.checkPing("https://".concat(e)).flatMap(function(r){return r?o.once(e):c.first().map(function(e){return u(a(e),3)}).flatMap(function(e){return o.fromArray(e)}).flatMapConcat(function(e){return o.fromArray(e).filter(function(){return n}).flatMap(function(e){return t.checkPing("https://".concat(e)).map(function(t){return t?(n=!1,e):null})})}).reduce(null,function(e,n){return e||n})})},t.onlineCheck=function(){return o.fromArray(s.get().connectionCheckDomains).flatMap(function(e){return t.checkConnection(e.url,e.code)}).filter(function(e){return e}).mapEnd(!1).first()},t.connectivityCheck=function(e){var n=e.stickyFrontingDomain,r=e.error;return t.onlineCheck().flatMap(function(e){return e?o.combineTemplate({apiUrl:t.apiConnectionCheck(),cgApiUrl:t.cgApiConnectionCheck(),websiteWorks:t.websiteConnectionCheck()}).flatMap(function(o){var i=o.apiUrl,a=o.cgApiUrl,u=o.websiteWorks;return i&&a&&u?{apiUrl:i,cgApiUrl:a,websiteWorks:u,online:e,error:r}:t.apiFrontingCheck(n).map(function(n){return{frontingDomain:n,apiUrl:i,cgApiUrl:a,websiteWorks:u,online:e,error:r}})}):{online:e,error:r}})}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./fronting_domains":31,"./util":62,config:9,xhr:68}],12:[function(e,n,t){"use strict";function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function r(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function i(e,n){for(var t=0;t<n.length;t++){var o=n[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function a(e,n,t){return n&&i(e.prototype,n),t&&i(e,t),e}function u(e,n){return!n||"object"!==o(n)&&"function"!=typeof n?s(e):n}function s(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),n&&d(e,n)}function d(e,n){return(d=Object.setPrototypeOf||function(e,n){return e.__proto__=n,e})(e,n)}var f=e("./config"),p=e("./emitter"),m=chrome,g=m.cookies,b=function(e){function n(){var e;return r(this,n),e=u(this,c(n).call(this)),e.addListener(),e}return l(n,e),a(n,[{key:"getAuthCookie",value:function(){var e=this;return new Promise(function(n){return g.get({url:"https://".concat(f.get().authApiDomain),name:"auth_website_session"},function(t){t&&e.triggerLogin(t.value),n(t)})})}},{key:"removeAuthCookie",value:function(){g.remove({url:"https://".concat(f.get().authApiDomain),name:"auth_website_session"})}},{key:"triggerLogin",value:function(e){var n=JSON.parse(atob(e)),t={auth_method:"token",auth_id:n.id,auth_secret:n.token};this.trigger("login",t)}},{key:"addListener",value:function(){var e=this;g.onChanged.addListener(function(n){var t=n.cookie,o=n.removed,r=t.domain,i=t.name,a=t.path,u=t.value;r===f.get().authApiDomain&&"auth_website_session"===i&&"/"===a&&(o?e.trigger("logout"):e.triggerLogin(u))})}}]),n}(p);n.exports=new b},{"./config":9,"./emitter":27}],13:[function(e,n,t){(function(t){"use strict";function o(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},o=Object.keys(t);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(t).filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),o.forEach(function(n){r(e,n,t[n])})}return e}function r(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function i(e,n){return Math.floor((e-n)/1e3/60/60/24)}function a(e){var n,t,r,a,s=e.user,f=e.device,m=e.language,g=e.defaultLocation,b=e.reason,y=e.tab,w=e.apiData,v=new Date,h=u.getName(),_=-1;return s&&(v=p(s.server_time),n=s.country_code||null,t=s.actual_country||null),y&&(a=y.domain),f&&(_=i(v,p(f.created_at))),h&&(h=h.toLowerCase()),g&&(r=g.country_code),l.fromPromise(c({url:"".concat(d.get().newsServiceUrl,"/crm"),responseType:"json",data:o({locale:m,country_code:n,platform:h,version:u.getVersion(),reason:b,days_since_install:_,current_connect_country:r,actual_country:t,current_context:a},w),headers:{"x-rm-url":d.get().newsServiceUrls[0]}})).skipErrors().map(function(e){return e.payload})}var u=e("browser"),s=e("xhr"),c=s.request,l="undefined"!=typeof window?window.Bacon:void 0!==t?t.Bacon:null,d=e("../config"),f=e("../util"),p=f.parseDate;n.exports=a}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../config":9,"../util":62,browser:8,xhr:68}],14:[function(e,n,t){"use strict";n.exports={login:"login",timer:"timer",initial:"initial",premium:"premium"}},{}],15:[function(e,n,t){(function(t){"use strict";var o="undefined"!=typeof window?window.Bacon:void 0!==t?t.Bacon:null,r=e("../account"),i=r.user,a=r.premiumChanges,u=e("./constants");n.exports=o.once({reason:u.initial}).merge(i.changes().first().delay(1e3).map({reason:u.login})).merge(a.changes().map({reason:u.premium})).merge(o.interval(864e5,{reason:u.timer})).flatMapLatest(function(){return o.once({})}).debounceImmediate(1e3).toProperty()}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../account":3,"./constants":14}],16:[function(e,n,t){(function(t){"use strict";function o(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},o=Object.keys(t);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(t).filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),o.forEach(function(n){r(e,n,t[n])})}return e}function r(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}var i="undefined"!=typeof window?window.Bacon:void 0!==t?t.Bacon:null,a=e("../account"),u=a.user,s=a.device,c=e("../locations/default"),l=e("../language"),d=l.language,f=e("./api"),p=e("../registration"),m=p.signIn,g=e("./constants"),b=e("./data");n.exports=i.later(2e3,{reason:g.initial}).merge(i.interval(54e5,{reason:g.timer})).merge(m.map(function(){return{reason:g.login}})).flatMapLatest(function(e){var n=e.reason,t=e.tab;return i.combineTemplate({user:u,apiData:b,device:s,language:d,defaultLocation:c}).map(function(e){var r=o({},e,{reason:n,tab:t});return n=null,t=null,r})}).debounceImmediate(2e3).flatMapLatest(f)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../account":3,"../language":36,"../locations/default":38,"../registration":54,"./api":13,"./constants":14,"./data":15}],17:[function(e,n,t){(function(t){"use strict";var o="undefined"!=typeof window?window.Bacon:void 0!==t?t.Bacon:null,r=e("browser"),i=e("storage"),a=e("../index"),u=o.fromPromise(i.read("notifications_blacklist")).mapError(function(){return[]}).flatMapLatest(function(e){return r.notificationEvents.filter(function(e){return"dontShowAgain"===e.event}).scan(e,function(e,n){var t=n.notificationId;return e.push(t),e})}).toProperty([]);u.onValue(function(e){i.write("notifications_blacklist",e)});var s=a.map(function(e){return e.contextNotification}).filter(function(e){return e}).combine(u,function(e,n){return n.includes(e.id)?null:e}).filter(function(e){return e});s.onValue(function(e){var n=e.id,t=e.title,o=e.text,i=e.actions,a={type:"basic",title:t,message:o,requireInteraction:!0};r.notify({chrome:{newsItem:a,data:{actions:i,id:n}}})}),n.exports=s}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../index":16,browser:8,storage:56}],18:[function(e,n,t){(function(t){"use strict";var o="undefined"!=typeof window?window.Bacon:void 0!==t?t.Bacon:null,r=e("storage"),i=e("../index"),a=e("../../popup"),u=a.popup,s=e("../../trial_end_promo"),c=s.showTrialEndNews,l=o.fromEvent(u,"request:popupOpen"),d=i.map(function(e){return e?e.news:void 0}).toProperty(null),f=o.mergeAll(c,d.filter(function(e){return e})).toProperty(null),p=o.fromPromise(r.read("previous_news")).mapError(function(){return[]}).flatMapLatest(function(e){return l.map(f).scan(e,function(e,n){return n&&!e.includes(n.id)&&e.push(n.id),e})}).toProperty();p.onValue(function(e){return r.write("previous_news",e)}),n.exports=f.combine(p,function(e,n){return e&&!n.includes(e.id)?e.isNew=!0:e&&(e.isNew=!1),e})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../../popup":52,"../../trial_end_promo":59,"../index":16,storage:56}],19:[function(e,n,t){(function(t){"use strict";function o(e){return a(e)||i(e)||r()}function r(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function i(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function a(e){if(Array.isArray(e)){for(var n=0,t=new Array(e.length);n<e.length;n++)t[n]=e[n];return t}}var u="undefined"!=typeof window?window.Bacon:void 0!==t?t.Bacon:null,s=e("storage"),c=e("browser"),l=e("../index"),d=l.map(function(e){return e.notification}).flatMapLatest(function(e){return u.combineAsArray(e,u.fromPromise(s.read("notifications")).mapError([]))}).toProperty();d.onValues(function(e,n){if(e&&-1===n.indexOf(e.id)){var t=e.id,r=e.title,i=e.text,a=e.url,u={type:"basic",title:r,message:i},l={title:r,text:i,data:{url:a}};return c.notify({chrome:{newsItem:u,data:{url:a}},firefox:l}),s.write("notifications",o(n).concat([t]))}}),n.exports=d}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../index":16,browser:8,storage:56}],20:[function(e,n,t){(function(t){"use strict";var o="undefined"!=typeof window?window.Bacon:void 0!==t?t.Bacon:null,r=e("storage"),i=e("../index"),a=e("../../popup"),u=a.popup,s=i.filter(function(e){return null!=e?e.popUp:void 0}).map(function(e){return e.popUp}).toProperty(null),c=o.fromPromise(r.read("dismissed_crm_popups")).mapError(function(){return[]}).flatMapLatest(function(e){return o.fromEvent(u,"request:dismissCRMPopUp").map(function(n){return[n].concat(e)}).merge(o.once(e))});c.onValue(function(e){return r.write("dismissed_crm_popups",e)}),n.exports=s.combine(c,function(e,n){return e&&n.includes(e.id)?null:e})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../../popup":52,"../index":16,storage:56}],21:[function(e,n,t){(function(t){"use strict";var o="undefined"!=typeof window?window.Bacon:void 0!==t?t.Bacon:null,r=e("storage"),i=e("browser"),a=e("../index"),u=e("../../popup"),s=u.popup,c=e("../../trial_end_promo"),l=c.showTrialEndTab,d=o.fromEvent(s,"request:popupOpen"),f=a.map(function(e){return e?e.tabSpawn:null}).toProperty(null),p=l.toProperty(null),m=o.mergeAll(p,f.filter(function(e){return e})).toProperty(null),g=o.fromPromise(r.read("previous_tab_spawns")).mapError(function(){return[]}).flatMapLatest(function(e){return d.map(m).scan(e,function(e,n){return n&&!e.includes(n.id)&&(i.openPage(n.url),e.push(n.id)),e})}).toProperty();g.onValue(function(e){return r.write("previous_tab_spawns",e)}),n.exports=m.combine(g,function(e,n){return e&&!n.includes(e.id)?e:null})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../../popup":52,"../../trial_end_promo":59,"../index":16,browser:8,storage:56}],22:[function(e,n,t){"use strict";function o(e){return a(e)||i(e)||r()}function r(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function i(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function a(e){if(Array.isArray(e)){for(var n=0,t=new Array(e.length);n<e.length;n++)t[n]=e[n];return t}}function u(e){throw new Error('"'+e+'" is read-only')}function s(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},o=Object.keys(t);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(t).filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),o.forEach(function(n){c(e,n,t[n])})}return e}function c(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function l(e){function n(e,n){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4?arguments[4]:void 0;return i&&(t.Authorization=i),new Promise(function(i,a){f({url:"".concat(p.get().cgApiURLs[r]).concat(e),requestType:"json",responseType:"json",skipEnvParams:!0,method:n,data:o,headers:s({"x-app-key":p.get().cgAppKey,"x-rm-url":p.get().cgApiURLs[r]},t)}).then(function(e){i(e.payload)}).catch(function(e){a(e)})})}var t={},r={};return r.createUser=function(e){return n("/users?zm_ext=true","POST",{useremail:e.email,password:e.password,username:e.userName},1).then(w)},r.createAuthToken=function(){return n("/v2/my/account/authtoken","GET",{fields:"(*)"})},r.createDevice=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return n("/v2/my/devices?fields=(*)&zm_ext=true","POST",{userName:e.userName,password:e.password,import:!!e.import}).then(function(n){return"import needed"===n.errorMessage?Promise.reject({message:"import needed",userName:e.userName,password:e.password}):v(n)})},r.getUser=function(){return n("/v2/my/account","GET",{fields:"(*)"}).then(y)},r.getUserDays=function(){return n("/v2/my/account/crm","GET",{fields:"(*)"})},r.getAllServerCountries=function(){return n("/v2/my/servers/extension","GET")},r.getDNSName=function(e){return f({url:decodeURIComponent(e),method:"GET",skipEnvParams:!0})},r.getLocationNodeBrowsing=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return new Promise(function(n,t){if(!e.length)return u("country"),o="DE",n({country:o,nodes:[]});var o=e[0].countrycode,r=g(e)[0];n({country:o,nodes:r.dnsname?[r.dnsname]:[]})})},r.getLocationNodeStreaming=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return new Promise(function(n,t){if(!e.length)return u("country"),o="DE",n({country:o,nodes:[]});var o=e[0].countrycode,r=g(e)[0];n({country:o,nodes:r.dnsname?[r.dnsname]:[]})})},r.getLocationsSplit=function(){return new Promise(function(e,n){r.getAllServerCountries().then(function(t){Promise.all(Object.keys(t.browsing).map(function(e){return r.getLocationNodeBrowsing(t.browsing[e])})).then(function(o){Promise.all(Object.keys(t.streaming).filter(function(e){return"gb"==e.toLowerCase()||"us"==e.toLowerCase()}).map(function(e){return r.getLocationNodeStreaming(t.streaming[e])})).then(function(n){e([o,n])}).catch(n)}).catch(n)}).catch(n)})},r.getLocations=function(e){return new Promise(function(n,t){var i={},a=e||"";a?r.getBestLocationsByCountryCode(a).then(function(e){var a=e[0].countrycode;r.getLocationsSplit().then(function(e){i={browsing:o(h(e[0],a)),streaming:o(h(e[1],a))},n(i)}).catch(t)}).catch(t):r.getLocationsSplit().then(function(e){i={browsing:o(h(e[0],a)),streaming:o(h(e[1],a))},n(i)}).catch(t)})},r.getBestLocationsByCountryCode=function(e){return n("/v2/my/servers/filters/111","GET",{filter_user_country:e})},r.sendTrial=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return n("/users/me/trial","POST",{email:e},1,t?"Bearer ".concat(t):"")},r.recoverToken=function(e){return n("/v2/my/account/recovertoken","POST",{email:e})},r.removeDevice=function(e){return n("/v2/my/devices/".concat(e),"DELETE")},r.setAuthHeaders=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t=e.uuid&&e.tokenSecret?{"x-device-id":e.uuid,"x-device-secret":e.tokenSecret}:{},r},r.setAuthHeaders(e),r}var d=e("../xhr"),f=d.request,p=e("../config"),m=e("../util"),g=m.shuffle,b=e("./transformations"),y=b.transformUser,w=b.transformUserV1,v=b.transformDevice,h=b.transformLocations;n.exports=l},{"../config":9,"../util":62,"../xhr":68,"./transformations":25}],23:[function(e,n,t){"use strict";function o(){return[{country_code:"AL",country_name:"AL",available:!0,premium_only:!0,nodes:[],best:!1,isFavorite:!1},{country_code:"AT",country_name:"AT",available:!0,premium_only:!0,nodes:[],best:!1,isFavorite:!1},{country_code:"AU",country_name:"AU",available:!0,premium_only:!0,nodes:[],best:!1,isFavorite:!1},{country_code:"BE",country_name:"BE",available:!0,premium_only:!0,nodes:[],best:!1,isFavorite:!1},{country_code:"BG",country_name:"BG",available:!0,premium_only:!0,nodes:[],best:!1,isFavorite:!1},{country_code:"BR",country_name:"BR",available:!0,premium_only:!0,nodes:[],best:!1,isFavorite:!1},{country_code:"CA",country_name:"CA",available:!0,premium_only:!0,nodes:[],best:!1,isFavorite:!1},{country_code:"CH",country_name:"CH",available:!0,premium_only:!0,nodes:[],best:!1,isFavorite:!1},{country_code:"CZ",country_name:"CZ",available:!0,premium_only:!0,nodes:[],best:!1,isFavorite:!1},{country_code:"DK",country_name:"DK",available:!0,premium_only:!0,nodes:[],best:!1,isFavorite:!1},{country_code:"ES",country_name:"ES",available:!0,premium_only:!0,nodes:[],best:!1,isFavorite:!1},{country_code:"FI",country_name:"FI",available:!0,premium_only:!0,nodes:[],best:!1,isFavorite:!1},{country_code:"FR",country_name:"FR",available:!0,premium_only:!0,nodes:[],best:!1,isFavorite:!1},{country_code:"GB",country_name:"GB",available:!0,premium_only:!0,nodes:[],best:!1,isFavorite:!1},{country_code:"HU",country_name:"HU",available:!0,premium_only:!0,nodes:[],best:!1,isFavorite:!1},{country_code:"IL",country_name:"IL",available:!0,premium_only:!0,nodes:[],best:!1,isFavorite:!1},{country_code:"IT",country_name:"IT",available:!0,premium_only:!0,nodes:[],best:!1,isFavorite:!1},{country_code:"JP",country_name:"JP",available:!0,premium_only:!0,nodes:[],best:!1,isFavorite:!1},{country_code:"KR",country_name:"KR",available:!0,premium_only:!0,nodes:[],best:!1,isFavorite:!1},{country_code:"LT",country_name:"LT",available:!0,premium_only:!0,nodes:[],best:!1,isFavorite:!1},{country_code:"LU",country_name:"LU",available:!0,premium_only:!0,nodes:[],best:!1,isFavorite:!1},{country_code:"LV",country_name:"LV",available:!0,premium_only:!0,nodes:[],best:!1,isFavorite:!1},{country_code:"MD",country_name:"MD",available:!0,premium_only:!0,nodes:[],best:!1,isFavorite:!1},{country_code:"NL",country_name:"NL",available:!0,premium_only:!0,nodes:[],best:!1,isFavorite:!1},{country_code:"NO",country_name:"NO",available:!0,premium_only:!0,nodes:[],best:!1,isFavorite:!1},{country_code:"PL",country_name:"PL",available:!0,premium_only:!0,nodes:[],best:!1,isFavorite:!1},{country_code:"RS",country_name:"RS",available:!0,premium_only:!0,nodes:[],best:!1,isFavorite:!1},{country_code:"RU",country_name:"RU",available:!0,premium_only:!0,nodes:[],best:!1,isFavorite:!1},{country_code:"SE",country_name:"SE",available:!0,premium_only:!0,nodes:[],best:!1,isFavorite:!1},{country_code:"SG",country_name:"SG",available:!0,premium_only:!0,nodes:[],best:!1,isFavorite:!1},{country_code:"SK",country_name:"SK",available:!0,premium_only:!0,nodes:[],best:!1,isFavorite:!1},{country_code:"UA",country_name:"UA",available:!0,premium_only:!0,nodes:[],best:!1,isFavorite:!1},{country_code:"ZA",country_name:"ZA",available:!0,premium_only:!0,nodes:[],best:!1,isFavorite:!1}]}n.exports={premiumLocations:o}},{}],24:[function(e,n,t){(function(t){"use strict";function o(e,n){return a(e)||i(e,n)||r()}function r(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function i(e,n){var t=[],o=!0,r=!1,i=void 0;try{for(var a,u=e[Symbol.iterator]();!(o=(a=u.next()).done)&&(t.push(a.value),!n||t.length!==n);o=!0);}catch(e){r=!0,i=e}finally{try{o||null==u.return||u.return()}finally{if(r)throw i}}return t}function a(e){if(Array.isArray(e))return e}function u(e){return function(){for(var n=arguments.length,t=new Array(n),r=0;r<n;r++)t[r]=arguments[r];return m.retry({source:function(){return m.fromPromise(e.apply(void 0,t)).flatMapError(function(e){return m.combineAsArray([e,y]).flatMap(function(e){var n=o(e,2),t=n[0],r=n[1];return h({error:t,stickyFrontingDomain:r}).flatMap(function(e){return m.once(new m.Error(e))})})})},retries:2,isRetryable:function(e){console.error("CG REQUEST ERROR",e);var n=e.error;return!!e.online&&(e.frontingDomain?w(e.frontingDomain):e.cgApiUrl&&_.setCGApiURL(e.cgApiUrl),(!n||"import needed"!==n.message)&&!(n&&[402,403,404,409,422,429].indexOf(n.status)>-1))},delay:function(){return 15e3}})}}function s(e){return function(){for(var n=arguments.length,t=new Array(n),o=0;o<n;o++)t[o]=arguments[o];return m.fromPromise(g.read("device")).skipErrors().flatMapLatest(function(n){return u(e).apply(void 0,[n].concat(t))})}}function c(e){var n=e.email,t=e.password,o=L();return new Promise(function(e,r){o.createUser({email:n,password:t,userName:n}).then(function(i){o.sendTrial(n,i.jwt),o.createDevice({userName:n,password:t}).then(function(n){o.setAuthHeaders(n),o.createAuthToken().then(function(e){x.openPage("".concat(_.get().accountRedirector,"?auth=").concat(e.authToken))});var t=i.country_code||null;o.getLocations(t).then(function(t){if(!i.is_premium&&!i.is_trial){var o=t.browsing.concat(E());t.browsing=o}return e({user:i,locations:t,device:n})}).catch(r)}).catch(r)}).catch(r)})}function l(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=L();return new Promise(function(t,r){n.createDevice({userName:e.email,password:e.password,import:e.import}).then(function(i){n.setAuthHeaders(i),Promise.all([n.getUser(),n.getUserDays()]).then(function(a){var u=o(a,2),s=u[0],c=u[1];e.account&&n.createAuthToken().then(function(e){x.openPage("".concat(_.get().accountRedirector,"?auth=").concat(e.authToken))}),g.write("userDays",c),console.log("User INFO ",s);var l=s.country_code||null;n.getLocations(l).then(function(e){if(!s.is_premium&&!s.is_trial){var n=e.browsing.concat(E());e.browsing=n}return t({user:s,locations:e,device:i,userDays:c})}).catch(r)}).catch(r)}).catch(r)})}function d(e){var n=e.email,t=L();return new Promise(function(e,o){t.recoverToken(n).then(e).catch(o)})}function f(e){var n=L(e);return new Promise(function(t,o){n.removeDevice(e.uuid).then(t).catch(o)})}function p(e){var n=L(e);return new Promise(function(t,r){Promise.all([n.getUser(),n.getLocations()]).then(function(n){var r=o(n,2),i=r[0],a=r[1];return t({user:i,locations:a,device:e})}).catch(r)})}var m="undefined"!=typeof window?window.Bacon:void 0!==t?t.Bacon:null,g=e("../storage"),b=e("fronting"),y=b.stickyFrontDomain,w=b.enableFullFronting,v=e("../connectivity"),h=v.connectivityCheck,_=e("../config"),L=e("./api_client"),x=e("../browser"),k=(e("cookie"),e("./defaultLocation")),E=k.premiumLocations;n.exports={signUpStream:u(c),signInStream:u(l),resetPasswordStream:u(d),signOutStream:s(f),refreshDataStream:s(p)}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../browser":8,"../config":9,"../connectivity":11,"../storage":56,"./api_client":22,"./defaultLocation":23,cookie:12,fronting:30}],25:[function(e,n,t){"use strict";function o(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{id:e.id,email:e.userEmail,actual_country:null,account_type:e.activeProduct.plan.planType,country_code:e.location?e.location.countrycode:null,premium_expires_at:null,is_premium:"paid"==e.activeProduct.plan.planType,is_trial:!!e.activeProduct.plan.planType.includes("paidTrial"),is_free:!!e.activeProduct.plan.planType.includes("free"),is_anonymous:null,location:e.location,server_time:null,created_at:null,is_verified:null,has_recurring_subscription:!!e.activeProduct.recurring,current_ip:null,device_count:e.deviceCount,
subscription:{sku:e.activeProduct.plan.internalName},active_product:e.activeProduct.id,renew_date:(((e||"").activeSubscription||"").lastValidBilling||"").endDate||""}}function r(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{id:e.id,email:e.user_email,jwt:e.jwt,actual_country:e.location.countryname,account_type:e.subscription.product.plan.plan_type,country_code:e.location.countrycode,premium_expires_at:null,is_premium:"paid"==e.subscription.product.plan.plan_type,is_trial:!!e.subscription.product.plan.plan_type.includes("paidTrial"),is_free:!!e.subscription.product.plan.plan_type.includes("free"),is_anonymous:null,server_time:null,created_at:null,is_verified:null,has_recurring_subscription:!1,current_ip:e.location.ip,device_count:e.subscription.product.plan.max_devices,subscription:{sku:e.subscription.product.plan.internal_name},active_product:e.subscription.product.id,renew_date:""}}function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{uuid:e.id,token:e.token,tokenSecret:e.tokenSecret,created_at:null}}function a(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1?arguments[1]:void 0;return e.map(function(e){return{country_code:e.country,country_name:e.country,available:!0,premium_only:null,nodes:e.nodes||[],best:n==e.country}})}n.exports={transformUser:o,transformUserV1:r,transformDevice:i,transformLocations:a}},{}],26:[function(e,n,t){(function(e){"use strict"}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./config":9,"./popup":52,browser:8,loglevel:1,storage:56}],27:[function(e,n,t){"use strict";function o(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function r(e,n){for(var t=0;t<n.length;t++){var o=n[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function i(e,n,t){return n&&r(e.prototype,n),t&&r(e,t),e}var a=function(){function e(){o(this,e),this.listeners={}}return i(e,[{key:"off",value:function(e,n){return this.listeners[e]=this.listeners[e]?this.listeners[e].filter(function(e){return e!==n}):void 0}},{key:"on",value:function(e,n){return this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].push(n)}},{key:"trigger",value:function(e,n){if(this.listeners[e])return this.listeners[e].map(function(e){return e(n)})}}]),e}();n.exports=a},{}],28:[function(e,n,t){(function(t){"use strict";var o,r="undefined"!=typeof window?window.Bacon:void 0!==t?t.Bacon:null,i=e("storage"),a=e("browser"),u=e("./popup"),s=u.popup,c=e("./options"),l=c.options,d=e("./logged-in"),f=e("page_api"),p=a.notificationEvents.filter(function(e){var n=e.event;return n.startsWith("enable")||n.startsWith("disable")}).map(function(e){return e.event.startsWith("enable")}),m=r.fromEvent(l,"request:reset").flatMap(function(){return r.sequentially(25,[!1,!0])});n.exports=o=r.fromPromise(i.read("enabled")).mapError(function(){return!0}).merge(r.fromEvent(f,"toggle")).merge(r.fromEvent(s,"request:toggleProxy")).merge(m).merge(p).merge(d.skip(1).changes().map(function(){return!0})).skipDuplicates().toProperty(),o.onValue(function(e){return!0===e?i.write("enabled_start",Date.now()):i.read("enabled_start",!1).then(function(e){if(e)return i.write("enabled_for",(Date.now()-e)/1e3),i.delete("enabled_start")}),i.write("enabled",e)})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./logged-in":42,"./options":45,"./popup":52,browser:8,page_api:49,storage:56}],29:[function(e,n,t){(function(t){"use strict";var o="undefined"!=typeof window?window.Bacon:void 0!==t?t.Bacon:null,r=e("storage"),i=e("./popup"),a=i.popup,u=e("auth"),s=e("./account"),c=s.user,l={malwareBlocking:"m",trackingProtection:"t"},d=o.fromEvent(a,"request:toggleMalware"),f=o.fromEvent(a,"request:toggleTracking"),p=o.fromPromise(r.read("features")).mapError(function(){return{}}).flatMap(function(e){return o.combineTemplate({malwareBlocking:d.startWith(e.malwareBlocking||!1),trackingProtection:f.startWith(e.trackingProtection||!1)}).combine(c,function(e,n){return n&&n.is_premium?e:{}})});n.exports=p,p.onValue(function(e){var n="";for(var t in e){e[t]&&(n+=l[t])}return u.setFeatureFlags(n),r.write("features",e)})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./account":3,"./popup":52,auth:5,storage:56}],30:[function(e,n,t){(function(t){"use strict";function o(e){return"".concat(e.replace("https","*"),"/*")}function r(e){return new URL(e).hostname}function i(e){return"*://".concat(e,"/*")}function a(e){f.write("fronting_domain",e),p.setApiURL("https://".concat(e)),p.setNewsServiceUrl("https://".concat(e)),p.setDfsUrl("https://".concat(e)),p.setAuthApiDomain(e)}function u(e,n){var t=n.filter(function(n){return!e[n.name.toLowerCase()]});return Object.keys(e).forEach(function(n){t.push({name:n,value:e[n]})}),t}function s(){E(!0)}function c(n){if(!P){P=!0,a(n);var t=x.map(i),r=p.get().websiteDomains.map(function(e){return i("*.".concat(e))}),s=t.concat(r);s.push(o(p.get().geoRedirector)),s.push(i(p.get().authApiDomains[0])),s.push(i(p.get().websiteAssets)),chrome.webRequest.onBeforeRequest.addListener(function(e){if(-1===e.tabId)return{};var t=new URL(e.url),o=t.hostname;"main_frame"===e.type&&(h[e.tabId]=o),"http:"===t.protocol&&(t.protocol="https:"),t.hostname=n;var r="".concat(t.toString());return"main_frame"!==e.type&&(r="".concat(r).concat(L).concat(o)),{redirectUrl:r}},{urls:s,types:w},["blocking"]),chrome.webRequest.onHeadersReceived.addListener(function(e){return h[e.tabId]?{responseHeaders:u({"access-control-allow-origin":"null","access-control-allow-credentials":"true","access-control-allow-headers":"content-type, Accept-Language, Authorization, xng-global-user-id","access-control-allow-methods":"GET, POST, PUT, PATCH, DELETE, OPTIONS","cache-control":"no-cache"},e.responseHeaders)}:{responseHeaders:e.responseHeaders}},{urls:[i(n)],types:["xmlhttprequest"]},["blocking","responseHeaders"]),chrome.webRequest.onBeforeSendHeaders.addListener(function(e){function t(t){return{requestHeaders:u({host:x.includes(t)?p.get().apiFront:p.get().websiteFront,"x-rm":"true","x-rm-host":t,"x-rm-front":n,"x-rm-main":o,"if-modified-since":"Thu, 01 Jan 1970 00:00:00 GMT"},e.requestHeaders)}}var o=h[e.tabId];if(!o)return{requestHeaders:e.requestHeaders};if(e.url.includes(L)){var r,i=e.url.match(/#x-rm-host=(.*)/i);if(i&&2===i.length&&(r=i[1]),r)return t(r)}return"main_frame"===e.type?t(o):v.includes(e.type)?t(p.get().websiteDomains.includes(o)?p.get().websiteAssets:o):"xmlhttprequest"===e.type?t(x[0]):{requestHeaders:e.requestHeaders}},{urls:[i(n)],types:w},["requestHeaders","blocking"]),chrome.tabs.onUpdated.addListener(function(t,o){if(h[t]){if(o&&o.status&&"loading"===o.status)return!_.includes(t)&&["Chrome"].includes(m.getName())?void m.openPopup(o.url,function(e){var n=e.tabs[0];chrome.tabs.remove(t),_.push(n.id),h[n.id]=h[t],setTimeout(function(){chrome.tabs.reload(n.id)},25)}):void chrome.tabs.executeScript(t,{runAt:"document_start",code:'\n      document.documentElement.dataset.rm = "true";\n      document.documentElement.dataset.rmHost = "'.concat(h[t],'";\n      document.documentElement.dataset.rmFront = "').concat(n,'";\n\n      function modifyXHR() {\n        (function(open){\n          window.XMLHttpRequest.prototype.open = function (method, path, async) {\n            var url = new URL(path);\n            var host = url.hostname;\n            if (window.location.hostname !== url.hostname){\n              url.hostname = "').concat(n,'";\n              path = url.toString() + "').concat(L,"\" + host;\n            }\n            return open.apply(this, [].slice.call(arguments));\n          }\n        })(window.XMLHttpRequest.prototype.open);\n      }\n\n      var inject = '(' + modifyXHR + ')();';\n\n      var script = document.createElement('script');\n      script.innerHTML = inject;\n      var parent = document.body || document.head || document.documentElement;\n      parent.appendChild(script);\n\n      (").concat(e("./../content/page_api"),")();\n    ")})}})}}function l(){return s(),new Promise(function(e){k.onValue(function(n){b({stickyFrontingDomain:n}).onValue(function(n){var t=n.online,o=n.apiUrl,r=n.frontingDomain;t&&(r?c(r):o&&p.setApiURL(o)),e()})})})}var d="undefined"!=typeof window?window.Bacon:void 0!==t?t.Bacon:null,f=e("./storage"),p=e("./config"),m=e("./browser"),g=e("./connectivity"),b=g.connectivityCheck,y=e("./fronting_domains"),w=["main_frame","xmlhttprequest","image","script","stylesheet","font","object","other","ping"],v=["image","script","stylesheet","font"],h={},_=[],L="#x-rm-host=",x=p.get().apiURLs.map(r),k=d.fromPromise(f.read("fronting_domain")).flatMapError(function(){return y.first().map(function(e){return e[Math.floor(Math.random()*e.length)]})}).toProperty(),E=function(){return console.log("Shouldn't be called")},I=d.fromBinder(function(e){E=e}).toProperty(!1);d.combineTemplate({frontingDomains:y,extensionApiFrontingEnabled:I}).filter(".extensionApiFrontingEnabled").onValue(function(e){var n=e.frontingDomains,t=n.map(i);chrome.webRequest.onBeforeSendHeaders.addListener(function(e){if(-1===e.tabId){var n=e.requestHeaders.filter(function(e){return"x-rm-url"===e.name}).reduce(function(e,n){return n.value},null),t=p.get().websiteFront;p.get().newsServiceUrls.includes(n)?t=p.get().newsServiceFront:p.get().apiURLs.includes(n)?t=p.get().apiFront:p.get().dfsURLs.includes(n)&&(t=p.get().dfsFront),e.requestHeaders.push({name:"Host",value:t})}return{requestHeaders:e.requestHeaders}},{urls:t,types:["xmlhttprequest"],tabId:-1},["requestHeaders","blocking"])});var P=!1,S=function(){return{fullFrontingEnabled:P}};n.exports={enableFronting:l,enableFullFronting:c,setFrontDomain:a,stickyFrontDomain:k,getFrontingState:S}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./../content/page_api":69,"./browser":8,"./config":9,"./connectivity":11,"./fronting_domains":31,"./storage":56}],31:[function(e,n,t){(function(t){"use strict";function o(){return r.fromPromise(s({url:"".concat(a.get().dfsURL,"/domains"),responseType:"json",headers:{"x-rm-url":a.get().dfsURLs[0]}})).map(".payload.domains")}var r="undefined"!=typeof window?window.Bacon:void 0!==t?t.Bacon:null,i=e("storage"),a=e("config"),u=e("xhr"),s=u.request,c=JSON.parse(atob(a.get().domainFronts)),l=r.once().merge(r.interval(864e5)).flatMap(o),d=r.fromPromise(i.read("fronting_domains")).mapError(function(){return c}).merge(l).skipErrors().toProperty();d.onValue(function(e){i.write("fronting_domains",e)}),n.exports=d}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{config:9,storage:56,xhr:68}],32:[function(e,n,t){(function(t){"use strict";function o(){return r.retry({source:function(){return r.fromPromise(a({url:"".concat(u.get().ipApi,"/ip?cb=true"),responseType:"json",method:"GET"}).then(function(e){return e.payload.country_code||"_unknown"}))},retries:2,delay:function(){return 250}})}var r="undefined"!=typeof window?window.Bacon:void 0!==t?t.Bacon:null,i=e("xhr"),a=i.request,u=e("./config"),s=e("./popup"),c=s.popup,l=e("storage"),d=r.fromEvent(c,"request:popupOpen").debounceImmediate(6e4),f=function(){return r.interval(54e5)},p=r.once().merge(d).flatMap(o).skipErrors().toProperty("_unknown");p.filter(function(e){return e}).onValue(function(e){return l.write("geo",e)}),n.exports={geoTick:f,geo:p}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./config":9,"./popup":52,storage:56,xhr:68}],33:[function(e,n,t){(function(n){"use strict";function o(e,n){return a(e)||i(e,n)||r()}function r(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function i(e,n){var t=[],o=!0,r=!1,i=void 0;try{for(var a,u=e[Symbol.iterator]();!(o=(a=u.next()).done)&&(t.push(a.value),!n||t.length!==n);o=!0);}catch(e){r=!0,i=e}finally{try{o||null==u.return||u.return()}finally{if(r)throw i}}return t}function a(e){if(Array.isArray(e))return e}var u,s="undefined"!=typeof window?window.Bacon:void 0!==n?n.Bacon:null,c=e("browser"),l=e("./tab-info"),d=e("./tab_state"),f=d.tabState,p=e("./logged-in"),m=e("./enabled"),g=e("./locations/current"),b=e("./rules"),y=b.rulesEnabled,w=e("./blocked"),v=w.proxyBlocked,h=e("./language"),_=h.messages,L=e("./account"),x=L.user,k=e("./crm/items/news"),E=e("./crm/items/tab_spawns"),I=e("./crm/items/popup");t.iconImage=s.combineAsArray(p,m.and(v.not()),f,y).onValues(function(e,n,t,o){return o&&t.isRuleActive&&t.isDirect?c.setIconImage("disabled"):e?n||o&&t.isRuleActive?c.setIconImage("enabled"):c.setIconImage("disabled"):c.setIconImage("signedOut")}),t.iconTitle=s.combineAsArray(p,m.and(v.not()),l,f,g,y,_).onValues(function(e,n,t,o,r,i,a){return i&&o.isRuleActive?t.host&&r.country_name?c.setIconTitle(a.icon_hover.connected.replace("{host}",t.host).replace("{country}",r.country_name)):c.setIconTitle(a.icon_hover.connected_undefined):i&&o.isRuleActive&&o.isDirect?c.setIconTitle(a.icon_hover.disabled_smart):e?n?o.isLocal?c.setIconTitle(a.icon_hover.local):t.host&&r.country_name?c.setIconTitle(a.icon_hover.connected.replace("{host}",t.host).replace("{country}",r.country_name)):c.setIconTitle(a.icon_hover.connected_undefined):c.setIconTitle(a.icon_hover.disabled):c.setIconTitle(a.icon_hover.signed_out)}),t.iconBadge=u=s.combineAsArray(l,f,g,y,x,k,E,I).map(function(e){var n=o(e,8),t=n[0],r=n[1],i=n[2],a=n[3],u=(n[4],n[5]),s=n[6],c=n[7];return a&&r.isRuleActive&&r.isDirect?["off",t.id]:a&&r.isRuleActive?[i.country_code.toLowerCase(),t.id]:u&&u.isNew&&u.showBadge||s||c?["1",t.id,"#CC3333"]:["",t.id]}),u.onValue(function(e){var n=o(e,3),t=n[0],r=n[1],i=n[2];c.setIconBadge(t,r,i)})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./account":3,"./blocked":6,"./crm/items/news":18,"./crm/items/popup":20,"./crm/items/tab_spawns":21,"./enabled":28,"./language":36,"./locations/current":37,"./logged-in":42,"./rules":55,"./tab-info":57,"./tab_state":58,browser:8}],34:[function(e,n,t){(function(n){"use strict";var t=(e("./config"),"undefined"!=typeof window?window.Bacon:void 0!==n?n.Bacon:null);e("./debug_overrides"),e("./install_source"),e("./logged-in"),e("./registration"),e("./crm/items/notifications"),e("./crm/items/context_notifications"),e("./crm/items/tab_spawns"),e("./icon_state"),e("./connect"),e("./widget"),e("./blocked_sites");var o=e("browser"),r=e("./language"),i=r.language,a=e("tab-info"),u=e("./tab_state"),s=u.tabState,c=e("./popup"),l=c.popup,d=e("./options"),f=d.options,p=e("./page"),m=p.page,g=e("./enabled"),b=e("page_api"),y=e("./account"),w=y.user,v=y.device,h=e("./locations"),_=e("./locations/default"),L=e("./locations/streaming"),x=e("./locations/current"),k=e("./crm/items/news"),E=e("./crm/items/popup"),I=e("./features"),P=e("./rules"),S=P.rules,A=P.rulesEnabled,C=e("./url-resolver"),O=e("blocked"),j=O.proxyBlocked,R=O.proxyBlockedBy,T=e("./connectivity"),F=T.connectivityCheck,D=e("./fronting"),B=D.getFrontingState,U=D.stickyFrontDomain,W=e("./webrtc"),N=W.webrtcProxyEnabled,M=e("./geo"),Y=M.geo,V=t.combineTemplate({user:w,device:v,news:k,crmPopUp:E,language:i,features:I,tabInfo:a,tabState:s,locations:h,currentLocation:x,defaultLocation:_,streamingLocation:L,enabled:g,rules:S,rulesEnabled:A,proxyBlocked:j,proxyBlockedBy:R,webrtcProxyEnabled:N,geo:Y});V.onValue(function(e){window.popupData=e}),V.changes().debounce(25).onValue(function(e){return l.send("response:data",e)}),t.fromEvent(b,"request:getData").flatMapLatest(function(e){return t.combineAsArray(e,w,v).take(1)}).onValues(function(e,n,t){return b.send("response:getData",e._sender,{timestamp:e.timestamp,version:o.getVersion(),user:n,device:t})}),t.fromEvent(l,"request:openPage").map(function(e){return C(e.url,e.params)}).onValue(o.openPage),t.fromEvent(m,"request:openPage").map(function(e){return C(e.url,e.params)}).onValue(o.openPage);var q=t.combineTemplate({user:w,device:v,enabled:g,currentLocation:x}).startWith({});t.fromEvent(f,"request:data").map(U).flatMapLatest(function(e){return F({stickyFrontingDomain:e})}).flatMapLatest(function(e){return t.combineTemplate({data:q,connectivity:e,fronting:B()})}).onValue(function(e){return f.send("response:data",e)});var Z=t.combineTemplate({user:w,language:i}).startWith({});t.fromEvent(m,"request:data").flatMapLatest(function(){return t.combineTemplate({data:Z})}).onValue(function(e){return m.send("response:data",e)}),t.fromEvent(l,"request:data").flatMapLatest(function(){return t.combineTemplate({data:V})}).onValue(function(e){l.send("response:data",e)})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./account":3,"./blocked_sites":7,"./config":9,"./connect":10,"./connectivity":11,"./crm/items/context_notifications":17,"./crm/items/news":18,"./crm/items/notifications":19,"./crm/items/popup":20,"./crm/items/tab_spawns":21,"./debug_overrides":26,"./enabled":28,"./features":29,"./fronting":30,"./geo":32,"./icon_state":33,"./install_source":35,"./language":36,"./locations":40,"./locations/current":37,"./locations/default":38,"./locations/streaming":41,"./logged-in":42,"./options":45,"./page":48,"./popup":52,"./registration":54,"./rules":55,"./tab_state":58,"./url-resolver":61,"./webrtc":64,"./widget":67,blocked:6,browser:8,page_api:49,"tab-info":57}],35:[function(e,n,t){(function(t){"use strict";var o,r="undefined"!=typeof window?window.Bacon:void 0!==t?t.Bacon:null,i=e("storage"),a=e("browser");e("./util"),e("loglevel");n.exports=o=r.fromPromise(i.read("install_source")).flatMapError(function(e){return r.fromCallback(a.getInstallSource)}).toProperty(),o.onValue(function(e){return i.write("install_source",e)})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./util":62,browser:8,loglevel:1,storage:56}],36:[function(e,n,t){(function(o){"use strict";var r,i="undefined"!=typeof window?window.Bacon:void 0!==o?o.Bacon:null,a=e("browser"),u=e("storage"),s=e("./popup"),c=s.popup,l=e("./page"),d=l.page,f="undefined"!=typeof window?window.locales:void 0!==o?o.locales:null;t.language=r=i.fromPromise(u.read("language")).mapError(function(){return a.getLocale()}).merge(i.fromEvent(c,"request:changeLanguage")).merge(i.fromEvent(d,"request:changeLanguage")).skipDuplicates().toProperty(),n.exports.messages=r.map(function(e){return f.getLocalization(e).messages}),r.onValue(function(e){return u.write("language",e)}),i.fromEvent(d,"request:language").flatMapLatest(function(){return r}).onValue(function(e){return d.send("response:language",e)})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./page":48,"./popup":52,browser:8,storage:56}],37:[function(e,n,t){(function(t){"use strict";var o="undefined"!=typeof window?window.Bacon:void 0!==t?t.Bacon:null,r=e("../tab_state"),i=r.tabState,a=e("../rules"),u=a.rulesEnabled,s=e("./index"),c=e("./streaming"),l=e("./default"),d=o.combineTemplate({tabState:i,rulesEnabled:u,defaultLocation:l,locations:s,streaming:c}).map(function(e){var n=e.tabState,t=e.rulesEnabled,o=e.defaultLocation,r=e.locations;e.streaming;return t&&n.isRuleActive?n.isDirect?{country_code:"OFF",location:"ZenMate Off"}:r.find(function(e){return e.country_code===n.customCountry})||o:o});n.exports=d}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../rules":55,"../tab_state":58,"./default":38,"./index":40,"./streaming":41}],38:[function(e,n,t){(function(t){"use strict";function o(e,n){return a(e)||i(e,n)||r()}function r(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function i(e,n){var t=[],o=!0,r=!1,i=void 0;try{for(var a,u=e[Symbol.iterator]();!(o=(a=u.next()).done)&&(t.push(a.value),!n||t.length!==n);o=!0);}catch(e){r=!0,i=e}finally{try{o||null==u.return||u.return()}finally{if(r)throw i}}return t}function a(e){if(Array.isArray(e))return e}function u(e,n){return e.nodes&&e.nodes.length&&(!e.premium_only||n.is_premium)}var s="undefined"!=typeof window?window.Bacon:void 0!==t?t.Bacon:null,c=e("storage"),l=e("browser"),d=e("../popup"),f=d.popup,p=e("../account"),m=p.user,g=e("./index"),b=e("./streaming"),y=e("./favorite"),w=l.notificationEvents.filter(function(e){return e.event.startsWith("enableLocation")}).map(function(e){var n=e.event;return n.startsWith("enableLocationAndRefresh")&&setTimeout(function(){return chrome.tabs.reload()},250),n.split(":")[1]}),v=s.fromPromise(c.read("default_location")).mapError(function(){return"not_a_cc"}).merge(s.fromEvent(f,"request:changeLocation")).merge(w).skipDuplicates().combine(s.combineAsArray(g,y,b,m),function(e,n){var t=o(n,4),r=t[0],i=t[1],a=t[2],s=t[3];if(!r)return null;var c="";return Array.isArray(e)?"streaming"==e[1]&&!(c=a.find(function(n){return n.country_code===e[0]}))&&a.length&&(c=a.find(function(e){return u(e,s)})):c=r.find(function(n){return n.country_code===e}),c||(c=r.find(function(e){return e.best&&u(e,s)})),c||(c=r.find(function(e){return u(e,s)})),c?(c.isFavorite=i.includes(c.country_code),c):null}).filter(function(e){return e}).toProperty();v.onValue(function(e){c.write("default_location",e.country_code)}),n.exports=v}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../account":3,"../popup":52,"./favorite":39,"./index":40,"./streaming":41,browser:8,storage:56}],39:[function(e,n,t){(function(t){"use strict";function o(e){return a(e)||i(e)||r()}function r(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function i(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function a(e){if(Array.isArray(e)){for(var n=0,t=new Array(e.length);n<e.length;n++)t[n]=e[n];return t}}function u(e){return function(n){return o(n).concat(o(e))}}function s(e){return function(n){return n.includes(e)?o(n):o(n).concat([e])}}function c(e){return function(n){return n.filter(function(n){return n!==e})}}var l="undefined"!=typeof window?window.Bacon:void 0!==t?t.Bacon:null,d=e("storage"),f=e("../popup"),p=f.popup,m=l.fromPromise(d.read("favorite_locations")).mapError(function(){return[]}),g=l.fromEvent(p,"request:addFavoriteLocation"),b=l.fromEvent(p,"request:removeFavoriteLocation"),y=l.when([m],u,[g],s,[b],c).scan([],function(e,n){return n(e)});y.onValue(function(e){d.write("favorite_locations",e)}),n.exports=y}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../popup":52,storage:56}],40:[function(e,n,t){(function(t){"use strict";var o="undefined"!=typeof window?window.Bacon:void 0!==t?t.Bacon:null,r=e("storage"),i=e("./favorite"),a=e("../registration"),u=a.signUp,s=a.signIn,c=a.signOut,l=e("../popup"),d=l.popup,f=e("../update"),p=o.fromPromise(r.read("custom_locations")).mapError(function(){return[]}).concat(o.fromEvent(d,"request:addCustomLocation").map(function(e){return[e]})).filter(function(e){return e}).scan([],".concat");p.onValue(function(e){return r.write("custom_locations",e)});var m=o.fromPromise(r.read("default_locations")).skipErrors().merge(u.merge(s).merge(f).map(function(e){return e.locations.browsing})).filter(function(e){return e&&e.length}).merge(c.map(function(){return[]})).combine(i,function(e,n){return e.map(function(e){return e.isFavorite=n.includes(e.country_code),e})}).toProperty();m.onValue(function(e){return e?r.write("default_locations",e):r.delete("default_locations")}),n.exports=m}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../popup":52,"../registration":54,"../update":60,"./favorite":39,storage:56}],41:[function(e,n,t){(function(t){"use strict";var o="undefined"!=typeof window?window.Bacon:void 0!==t?t.Bacon:null,r=e("storage"),i=(e("./favorite"),e("../registration")),a=i.signUp,u=i.signIn,s=i.signOut,c=e("../popup"),l=(c.popup,e("../update")),d=o.fromPromise(r.read("streaming_locations")).skipErrors().merge(a.merge(u).merge(l).map(function(e){return e.locations.streaming})).merge(s.map(function(){return[]})).toProperty();d.onValue(function(e){return e?r.write("streaming_locations",e):r.delete("streaming_locations")}),n.exports=d||[]}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../popup":52,"../registration":54,"../update":60,"./favorite":39,storage:56}],42:[function(e,n,t){(function(t){"use strict";var o=e("browser"),r="undefined"!=typeof window?window.Bacon:void 0!==t?t.Bacon:null,i=e("./registration"),a=i.signUp,u=i.signIn,s=i.signOut,c=r.fromPromise(o.setup());c.onValue(function(e){return!e&&o.openSignupPage()});var l=c.merge(a.map(function(){return!0}).mapError(function(){return!1})).merge(u.map(function(){return!0}).mapError(function(){return!1})).merge(s.map(function(){return!1})).skipDuplicates().toProperty();l.onValue(function(e){return o.setIconAction(e?"popup":"")}),n.exports=l}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./registration":54,browser:8}],43:[function(e,n,t){"use strict";function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function r(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function i(e,n){for(var t=0;t<n.length;t++){var o=n[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function a(e,n,t){return n&&i(e.prototype,n),t&&i(e,t),e}function u(e,n){return!n||"object"!==o(n)&&"function"!=typeof n?s(e):n}function s(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),n&&d(e,n)}function d(e,n){return(d=Object.setPrototypeOf||function(e,n){return e.__proto__=n,e})(e,n)}var f=e("./emitter"),p=(e("loglevel"),function(e){function n(e){var t;return r(this,n),t=u(this,c(n).call(this)),t.name=e,t.port=null,chrome.runtime.onConnect.addListener(function(e){if(e.name===t.name){var n=t.port&&t.port.sender&&t.port.sender.tab&&t.port.sender.tab.id,o=e&&e.sender&&e.sender.tab&&e.sender.tab.id;return n&&o&&n!==o&&chrome.tabs.remove(t.port.sender.tab.id),t.port=e,t.port.onMessage.addListener(function(e){return t.trigger(e.subject,e.payload)}),t.port.onDisconnect.addListener(function(e){t.port=null})}}),t}return l(n,e),a(n,[{key:"send",value:function(e,n){try{this.port&&this.port.postMessage({subject:e,payload:n})}catch(e){return}}}]),n}(f));n.exports=p},{"./emitter":27,loglevel:1}],44:[function(e,n,t){(function(e){"use strict";function n(e,n){if(null==e)return{};var t,r,i=o(e,n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)t=a[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(i[t]=e[t])}return i}function o(e,n){if(null==e)return{};var t,o,r={},i=Object.keys(e);for(o=0;o<i.length;o++)t=i[o],n.indexOf(t)>=0||(r[t]=e[t]);return r}function r(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},o=Object.keys(t);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(t).filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),o.forEach(function(n){i(e,n,t[n])})}return e}function i(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function a(e){c.push({notificationId:e})}var u="undefined"!=typeof window?window.Bacon:void 0!==e?e.Bacon:null,s=new u.Bus,c=new u.Bus;c.onValue(function(e){var n=e.notificationId;chrome.notifications.clear(n,function(){})});var l=u.fromBinder(function(e){chrome.notifications.onClosed.addListener(function(n){return e({notificationId:n})})}),d=u.fromBinder(function(e){chrome.notifications.onButtonClicked.addListener(function(n,t){return e({notificationId:n,buttonIndex:t})})}),f=s.map(function(e){return{action:"add",notification:e}}),p=u.mergeAll(c,l).map(function(e){return{action:"remove",notification:e}}),m=u.mergeAll(f,p).scan({},function(e,n){var t=n.action,o=n.notification;return"add"===t?e[o.notificationId]=o:"remove"===t&&delete e[o.notificationId],e});m.sampledBy(d,function(e,n){return{notifications:e,click:n}}).onValue(function(e){var n=e.notifications,t=e.click,o=t.notificationId,i=t.buttonIndex,a=r({},n[o]);a.data.buttonActions[i](a),c.push({notificationId:o})}),t.notify=function(e){var t=e.id,o=e.title,i=e.message,a=e.buttons,u=e.requireInteraction,c=n(e,["id","title","message","buttons","requireInteraction"]),l=Date.now(),d=t||l.toString(),f={iconUrl:chrome.extension.getURL("images/notification_chrome@2x.png"),type:"basic",message:i,eventTime:l,title:o||chrome.runtime.getManifest().name,requireInteraction:u};a&&(f.buttons=a.map(function(e){return{title:e.title}}),c.buttonActions=a.map(function(e){return e.action})),chrome.notifications.create(d,f,function(e){s.push(r({notificationId:e},f,{data:c}))})},t.clear=a,t.clearAll=function(){m.first().onValue(function(e){Object.values(e).forEach(function(e){return a(e.notificationId)})})}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],45:[function(e,n,t){"use strict";var o=e("message_handler");t.options=new o("options")},{message_handler:43}],46:[function(e,n,t){"use strict";var o=e("../config"),r=e("../util"),i={localDomains:o.get().localDomains,nodeOverrides:o.get().nodeOverrides,IPv4NotationRE:/^\d+\.\d+\.\d+\.\d+$/g,localIPsRE:/(^127\.)|(^192\.168\.)|(^10\.)|(^172\.1[6-9]\.)|(^172\.2[0-9]\.)|(^172\.3[0-1]\.)/};n.exports={data:i,mergeRuleOverrides:function(e,n){if(!((e?e.length:void 0)>0))return[];if(!((n?n.length:void 0)>0))return e;var t=!0,o=!1,i=void 0;try{for(var a,u=e[Symbol.iterator]();!(t=(a=u.next()).done);t=!0){var s=a.value,c=!0,l=!1,d=void 0;try{for(var f,p=n[Symbol.iterator]();!(c=(f=p.next()).done);c=!0){var m=f.value;m.domains.indexOf(s.domain)>-1&&(s.hosts=r.concatUnique(s.hosts||[],m.hosts||[]))}}catch(e){l=!0,d=e}finally{try{c||null==p.return||p.return()}finally{if(l)throw d}}}}catch(e){o=!0,i=e}finally{try{t||null==u.return||u.return()}finally{if(o)throw i}}return e},nodeLookup:function(e,n){return e[n]||!1},compareHosts:function(e,n){var t=!0,o=!1,r=void 0;try{for(var i,a=e[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var u=i.value;if(this.matchWildcardDomain(n,u))return u}}catch(e){o=!0,r=e}finally{try{t||null==a.return||a.return()}finally{if(o)throw r}}},compareURLs:function(e,n){var t=!0,o=!1,r=void 0;try{for(var i,a=e[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var u=i.value;if(u.test(n))return u}}catch(e){o=!0,r=e}finally{try{t||null==a.return||a.return()}finally{if(o)throw r}}},dnsDomainIs:function(e,n){return e.length>=n.length&&e.substring(e.length-n.length)===n},matchWildcardDomain:function(e,n){var t=e===n,o=e.slice(-n.length)===n,r="."===e[e.lastIndexOf(n)-1];return t||o&&r},matchNodeOverride:function(e,n){var t=this,o=this.data.nodeOverrides.find(function(o){return o.target_cc===n&&t.compareHosts(o.hosts,e)});return!!o&&o.nodes},matchRules:function(e,n,t){
if(e&&e.length){this.data.rulesWithOverrides||(e=this.mergeRuleOverrides(e,o.get().ruleOverrides));for(var r=0;r<e.length;r++){var i=e[r];if(this.matchWildcardDomain(n,i.domain)||i.hosts&&this.compareHosts(i.hosts,n))return r}}},_getProxyState:function(e,n,t){if(e=e.toLowerCase(),this.data.IPv4NotationRE.lastIndex=0,this.data.localIPsRE.lastIndex=0,!~n.indexOf(".")&&!~n.indexOf(":"))return"LOCAL";if(this.data.IPv4NotationRE.test(n)&&this.data.localIPsRE.test(n))return"LOCAL";var o=!0,r=!1,i=void 0;try{for(var a,u=this.data.localDomains[Symbol.iterator]();!(o=(a=u.next()).done);o=!0){var s=a.value;if(this.matchWildcardDomain(n,s))return"LOCAL"}}catch(e){r=!0,i=e}finally{try{o||null==u.return||u.return()}finally{if(r)throw i}}var c=this.matchRules(t,n,e);return Number.isInteger(c)?t[c].cc:"DEFAULT"}}},{"../config":9,"../util":62}],47:[function(e,n,t){"use strict";function o(e,n){return a(e)||i(e,n)||r()}function r(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function i(e,n){var t=[],o=!0,r=!1,i=void 0;try{for(var a,u=e[Symbol.iterator]();!(o=(a=u.next()).done)&&(t.push(a.value),!n||t.length!==n);o=!0);}catch(e){r=!0,i=e}finally{try{o||null==u.return||u.return()}finally{if(r)throw i}}return t}function a(e){if(Array.isArray(e))return e}function u(e){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var s=e("../config"),c=e("../util"),l=e("./engine"),d=(e("loglevel"),function(e){e=e||l;for(var n=[],t=Object.keys(e),o=0;o<t.length;o++){var r=t[o],i=e[r],a=i.toString();switch(u(e[r])){case"function":a.startsWith("function")?n.push("".concat(r,": ").concat(a)):n.push("".concat(r,": function ").concat(a));break;case"object":n.push("".concat(r,": ").concat(JSON.stringify(e[r])))}}return"{ ".concat(n.join(",")," }")}),f="e.data.IPv4NotationRE = ".concat(l.data.IPv4NotationRE.toString(),";\ne.data.localIPsRE = ").concat(l.data.localIPsRE.toString(),";");t.exportPAC=function(e,n,t,o){return t=t||[],o=o||[],"/*ZenMate*/\nfunction FindProxyForURL(url, host) {\n\n  var e = ".concat(d(),";\n  e.data.localDomains = e.data.localDomains.concat(").concat(JSON.stringify(o),");\n  ").concat(f,"\n\n  e.data.defaultLocation = '").concat(e,"';\n  e.data.nodeDict = ").concat(JSON.stringify(n),";\n  e.data.rulesWithOverrides = ").concat(JSON.stringify(l.mergeRuleOverrides(t,s.get().ruleOverrides)),";\n\n  var res = e._getProxyState(url, host, e.data.rulesWithOverrides);\n  var cc;\n  if (res === 'LOCAL' || res === 'DIRECT' || res === 'OFF') {return 'DIRECT'};\n  if (res === 'DEFAULT') {cc = e.data.defaultLocation} else {cc = res};\n  var override = e.matchNodeOverride(host, cc);\n  if (override) {cc = override};\n\n  return e.nodeLookup(e.data.nodeDict, cc) || 'DIRECT';\n}")},t.getProxyStateByURL=function(e,n,t){return t=t||[],n=n||c.parseURL(e).host||e,l._getProxyState(e,n,t)},t.getNodeDictFromLocations=function(e,n,t){e=e.concat(s.get().alternativeNodes);var r={},i=!0,a=!1,u=void 0;try{for(var c,l=e[Symbol.iterator]();!(i=(c=l.next()).done);i=!0){var d=c.value,f=d.nodes.slice(0,15).map(function(e){var n=e.split(":"),r=o(n,2),i=r[0],a=r[1];return t?i:"HTTPS ".concat(i,":").concat(a?a.trim():443)});r[d.country_code]=f.join(";")}}catch(e){a=!0,u=e}finally{try{i||null==l.return||l.return()}finally{if(a)throw u}}return r},t.matchRules=function(e,n,t){return l.matchRules(e,n,t)}},{"../config":9,"../util":62,"./engine":46,loglevel:1}],48:[function(e,n,t){(function(n){"use strict";var o,r="undefined"!=typeof window?window.Bacon:void 0!==n?n.Bacon:null,i=e("message_handler"),a=e("browser");t.page=o=new i("page"),r.fromEventTarget(o,"request:closePage").onValue(function(){return a.closePage(a.getExtensionURL("page.html"))})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{browser:8,message_handler:43}],49:[function(e,n,t){"use strict";function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function r(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function i(e,n){for(var t=0;t<n.length;t++){var o=n[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function a(e,n,t){return n&&i(e.prototype,n),t&&i(e,t),e}function u(e,n){return!n||"object"!==o(n)&&"function"!=typeof n?s(e):n}function s(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),n&&d(e,n)}function d(e,n){return(d=Object.setPrototypeOf||function(e,n){return e.__proto__=n,e})(e,n)}var f=e("./emitter"),p=(e("loglevel"),function(e){function n(){var e;return r(this,n),e=u(this,c(n).call(this)),chrome.runtime.onMessage.addListener(function(n,t){if(n&&n.subject)return void 0===n.payload&&(n.payload={}),"object"===o(n.payload)&&(n.payload._sender=t),e.trigger(n.subject,n.payload)}),e}return l(n,e),a(n,[{key:"send",value:function(e,n,t){return chrome.tabs.sendMessage(n.tab.id,{subject:e,payload:t})}}]),n}(f));n.exports=new p},{"./emitter":27,loglevel:1}],50:[function(e,n,t){(function(t){"use strict";var o="undefined"!=typeof window?window.Bacon:void 0!==t?t.Bacon:null,r=e("page_api");n.exports=o.interval(18e5,[]).merge(o.fromEvent(r,"setPageExcludes")).toProperty([])}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{page_api:49}],51:[function(e,n,t){(function(e){"use strict";function n(e){return i(e)||r(e)||o()}function o(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function r(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function i(e){if(Array.isArray(e)){for(var n=0,t=new Array(e.length);n<e.length;n++)t[n]=e[n];return t}}var a="undefined"!=typeof window?window.Bacon:void 0!==e?e.Bacon:null,u=function(e){return e.permissions},s=a.fromCallback(chrome.permissions.getAll).map(u),c=new a.Bus,l=c.map(u).map(function(e){return{action:"add",permissions:e}});t.requestPermissions=function(e){return new Promise(function(n){return chrome.permissions.request({permissions:e},function(t){t&&c.push({permissions:e}),n(t)})})},t.permissions=s.flatMapLatest(function(e){return a.mergeAll(l).scan(e,function(e,t){var o=t.action,r=t.permissions;return"add"===o?e=n(e).concat(n(r)):"remove"===o&&(e=e.filter(function(e){return!r.include(e)})),e})})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],52:[function(e,n,t){"use strict";var o=e("message_handler");t.popup=new o("popup")},{message_handler:43}],53:[function(e,n,t){(function(t){"use strict";var o="undefined"!=typeof window?window.Bacon:void 0!==t?t.Bacon:null,r=e("loglevel"),i=e("./util"),a=o.fromBinder(function(e){i.isChrome?chrome.proxy.onProxyError.addListener(function(n){r.warn("Proxy error",n),e(n)}):browser.proxy.onError.addListener(function(n){r.warn("Proxy error",n),e(n)})});n.exports=a.debounceImmediate(3e4).toProperty(null)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./util":62,loglevel:1}],54:[function(e,n,t){(function(n){"use strict";function o(e,n){return a(e)||i(e,n)||r()}function r(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function i(e,n){var t=[],o=!0,r=!1,i=void 0;try{for(var a,u=e[Symbol.iterator]();!(o=(a=u.next()).done)&&(t.push(a.value),!n||t.length!==n);o=!0);}catch(e){r=!0,i=e}finally{try{o||null==u.return||u.return()}finally{if(r)throw i}}return t}function a(e){if(Array.isArray(e))return e}var u,s,c,l="undefined"!=typeof window?window.Bacon:void 0!==n?n.Bacon:null,d=e("./cyberghost/requests"),f=e("./popup"),p=f.popup,m=e("./page"),g=m.page,b=e("./install_source"),y=e("browser"),w=e("./update"),v=e("storage"),h=e("page_api"),_=e("./language"),L=_.messages,x=e("cookie"),k=l.fromEvent(p,"request:signOut");k.onValue(function(){return x.removeAuthCookie()}),t.signOut=c=k.merge(l.fromEvent(h,"removeCredentials")).merge(w.errors().mapError(function(e){return[401,403].indexOf(e.error.status)>-1}).filter(function(e){return e})).flatMapLatest(function(e){return d.signOutStream().map(function(){return e}).mapError(function(){return e})}),c.map(L.toProperty()).onValue(function(e){var n=e.notifications.logout,t={type:"basic",title:n.title,message:n.message},o={title:n.title,text:n.message};y.notify({chrome:{newsItem:t},firefox:o}),p.send("request:popupClose")}),t.signUp=u=l.fromEventTarget(g,"request:signUp").flatMapLatest(function(e){return l.combineAsArray(l.fromPromise(v.read("device",!1)),b,e)}).flatMapLatest(function(e){var n=o(e,3),t=n[0],r=(n[1],n[2]);return e.anonymous&&t&&t.uuid&&t&&t.token?(v.read("user",!1).then(function(e){return g.send("response:signUp",e)}),l.never()):d.signUpStream({email:r.email,password:r.password})}).flatMapError(function(e){var n=e.error;return l.fromPromise(new Promise(function(e,t){return t("onload"!==n.type?n:404==+n.status?Error("errors.user.email.not_found"):403==+n.status?Error("errors.user.email.taken"):402==+n.status?Error("errors.user.device_limit"):422==+n.status?n.payload.error_codes&&n.payload.error_codes.length?Error(n.payload.error_codes[n.payload.error_codes.length-1]):Error("errors.user.unknown_user_email_password"):429==+n.status?Error("errors.unknown"):Error("errors.unknown"))}))}),u.onValue(function(e){return g.send("response:signUp",e)}),u.onError(function(e){return g.send("error:signUp",e.message)}),t.signIn=s=l.fromEventTarget(g,"request:signIn").merge(l.fromEvent(h,"updateWithCredentials").map(function(e){var n=e.credentials;return{email:n.email,password:n.password,import:n.import,account:!1}})).flatMapLatest(function(e){return l.combineTemplate({install_source:b,data:e})}).flatMapLatest(function(e){var n=e.data;return d.signInStream({email:n.email,password:n.password,import:n.import,account:n.account})}).flatMapError(function(e){var n=e.error;return l.fromPromise(new Promise(function(e,t){return t("onload"!==n.type?n:403==+n.status?Error("errors.user.unknown_user_email_password"):404==+n.status?Error("errors.user.unknown_user_email_password"):402==+n.status?Error("errors.user.device_limit"):422==+n.status?n.payload.error_codes&&n.payload.error_codes.length?Error(n.payload.error_codes[n.payload.error_codes.length-1]):Error("errors.user.unknown_user_email_password"):429==+n.status?Error("errors.unknown"):Error("errors.unknown"))}))}),s.onValue(function(e){var n=e.user;return g.send("response:signIn",n)}),s.onError(function(e){"import needed"===e.message&&g.send("error:askForImport",e),g.send("error:signIn",e.message)});var E=l.fromEventTarget(g,"request:forgotPassword").flatMapLatest(function(e){var n=e.email;return d.resetPasswordStream({email:n})}).flatMapError(function(e){var n=e.error;return l.fromPromise(new Promise(function(e,t){return t("onload"!==n.type?n:404==+n.status?Error("errors.user.email.not_found"):422==+n.status?n.payload.error_codes&&n.payload.error_codes.length?Error(n.payload.error_codes[n.payload.error_codes.length-1]):Error("errors.user.unknown_user_email_password"):Error("error.unknown"))}))});E.onValue(function(){return g.send("response:forgotPassword")}),E.onError(function(e){return g.send("error:forgotPassword",e.message)})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./cyberghost/requests":24,"./install_source":35,"./language":36,"./page":48,"./popup":52,"./update":60,browser:8,cookie:12,page_api:49,storage:56}],55:[function(e,n,t){(function(n){"use strict";var o,r,i="undefined"!=typeof window?window.Bacon:void 0!==n?n.Bacon:null,a=e("storage"),u=e("./popup"),s=u.popup,c=e("./account"),l=c.user;t.rules=o=i.fromPromise(a.read("rules")).mapError(function(){return[]}).merge(i.fromEvent(s,"request:updateRules")).filter(function(e){return e}).toProperty(),o.onValue(function(e){return a.write("rules",e)}),t.rulesEnabled=r=i.fromPromise(a.read("rules_enabled")).map(function(e){return!!e}).mapError(function(){return!1}).merge(i.fromEvent(s,"request:toggleRules")).combine(l,function(e,n){return n&&(n.is_premium||n.is_trial)&&e}).skipDuplicates().toProperty(),r.onValue(function(e){return a.write("rules_enabled",e)})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./account":3,"./popup":52,storage:56}],56:[function(e,n,t){"use strict";function o(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}t.read=function(e){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return new Promise(function(t,o){return chrome.storage.local.get(e,function(r){r.hasOwnProperty(e)?t(r[e]):n?o(Error("Element ".concat(e," not found"))):t()})})},t.write=function(e,n){return new Promise(function(t){var r=o({},e,n);return chrome.storage.local.set(r,t)})},t.delete=function(e){return new Promise(function(n){return chrome.storage.local.remove(e,n)})}},{}],57:[function(e,n,t){(function(t){"use strict";var o="undefined"!=typeof window?window.Bacon:void 0!==t?t.Bacon:null,r=(e("loglevel"),e("./util")),i=e("./storage"),a=o.fromBinder(function(e){chrome.tabs.query({active:!0},function(n){n&&n.length&&e(n[0])}),chrome.tabs.onActivated.addListener(function(n){n&&chrome.tabs.get(n.tabId,e)}),chrome.tabs.onUpdated.addListener(function(n,t,o){o.active&&"complete"!==t.status&&o&&e(o)}),chrome.tabs.onRemoved.addListener(function(e){i.delete("tab_rule_"+e)})}).diff(null,function(e,n){chrome.runtime.lastError;var t=n&&n.url.includes("chrome-devtools://devtools");return n&&e&&t?null:n}).filter(function(e){return e}).map(function(e){return e.host=r.parseURL(e.url).host,e.favIconUrl=e.favIconUrl||"chrome://favicon/".concat(e.url),e}).toProperty();n.exports=a}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./storage":56,"./util":62,loglevel:1}],58:[function(e,n,t){(function(n){"use strict";var o="undefined"!=typeof window?window.Bacon:void 0!==n?n.Bacon:null,r=e("./util"),i=e("./rules"),a=i.rules,u=e("tab-info"),s=e("./pacengine"),c=function(e,n){var t=r.parseURL(e.url),o=s.getProxyStateByURL(e.url,t.host,n),i={isDefault:"DEFAULT"===o,isLocal:"LOCAL"===o,isDirect:"OFF"===o};return i.isRuleActive=!(i.isDefault||i.isLocal),i.isRuleActive&&!i.isDirect&&(i.customCountry=o),i};t.tabState=o.combineTemplate({tabInfo:u,rules:a}).map(function(e){var n=e.tabInfo,t=e.rules;if(n)return c(n,t)})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./pacengine":47,"./rules":55,"./util":62,"tab-info":57}],59:[function(e,n,t){"use strict";var o=e("./url-resolver"),r=e("./account"),i=r.user,a=e("./util"),u=a.parseDate;t.showTrialEndTab=i.flatMapLatest(function(e){if(e){var n={utm_medium:"crm",utm_source:"extension-tabspawn",utm_campaign:"premium-promotion"},t=o("account/premium",n),r=u(e.premium_expires_at||e.created_at);if(e.is_premium&&!e.has_recurring_subscription){var i=new Date;if(i.setDate(i.getDate()+1),r<i)return{url:t,id:"premium_end_promo"}}if(!e.is_premium){var a=new Date;a.setDate(a.getDate()-7);var s=new Date;s.setDate(s.getDate()-14);var c=new Date;c.setDate(c.getDate()-30);var l=new Date;l.setDate(l.getDate()-37);var d=new Date;if(d.setDate(d.getDate()-40),s<r&&r<a)return{url:t,id:"premium_end_promo2"};if(l<r&&r<c)return{url:t,id:"premium_end_promo3"};if(d<r&&r<l)return{url:t,id:"premium_end_promo4"}}}});var s=i.map(function(e){if(e&&!e.has_recurring_subscription){var n=u(e.premium_expires_at||e.created_at),t=new Date;t.setDate(t.getDate()+1);var o=new Date;o.setDate(o.getDate()-9);var r=new Date;r.setDate(r.getDate()-30);var i=new Date;return i.setDate(i.getDate()-40),o<n&&n<t||i<n&&n<r}});t.showTrialEndNews=s.flatMapLatest(function(e){var n={utm_medium:"crm",utm_source:"extension-banner",utm_campaign:"premium-promotion"},t=o("account/premium",n);if(e)return{text:"![".concat(t,"](images/tabspawn.gif)"),id:"premium_end_promo"}})},{"./account":3,"./url-resolver":61,"./util":62}],60:[function(e,n,t){(function(t){"use strict";var o="undefined"!=typeof window?window.Bacon:void 0!==t?t.Bacon:null,r=e("page_api"),i=e("./cyberghost/requests");n.exports=o.once().merge(o.interval(432e5)).merge(o.fromEvent(r,"update")).flatMapLatest(function(){return i.refreshDataStream()})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./cyberghost/requests":24,page_api:49}],61:[function(e,n,t){"use strict";function o(e,n){return a(e)||i(e,n)||r()}function r(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function i(e,n){var t=[],o=!0,r=!1,i=void 0;try{for(var a,u=e[Symbol.iterator]();!(o=(a=u.next()).done)&&(t.push(a.value),!n||t.length!==n);o=!0);}catch(e){r=!0,i=e}finally{try{o||null==u.return||u.return()}finally{if(r)throw i}}return t}function a(e){if(Array.isArray(e))return e}function u(e,n){return"".concat("https://geo.zenmate.com","/").concat(e,".").concat(p).concat(n?"?".concat(n):"")}function s(e){var n,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e.split("?"),i=o(r,2),a=i[0],s=i[1],c=Object.keys(t).map(function(e){return"".concat(e,"=").concat(t[e])}),l=c.join("&");return l=l&&s?"".concat(l,"&").concat(s):s||l,n=e.includes("://")?"".concat(a).concat(l?"?".concat(l):""):u(a,l),n=n.replace("{countryCode}",m)}var c=e("./language"),l=c.language,d=e("./account"),f=d.user,p="en",m="unknown";l.onValue(function(e){return p=e}),f.filter(function(e){return e}).onValue(function(e){return m=e.country_code}),n.exports=s},{"./account":3,"./language":36}],62:[function(e,n,t){"use strict";function o(e,n){return a(e)||i(e,n)||r()}function r(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function i(e,n){var t=[],o=!0,r=!1,i=void 0;try{for(var a,u=e[Symbol.iterator]();!(o=(a=u.next()).done)&&(t.push(a.value),!n||t.length!==n);o=!0);}catch(e){r=!0,i=e}finally{try{o||null==u.return||u.return()}finally{if(r)throw i}}return t}function a(e){if(Array.isArray(e))return e}t.generateInstallId=function(){var e=function(){return(65536*(1+Math.random())|0).toString(16).substring(1)};return"".concat(e()+e(),"-").concat(e(),"-").concat(e(),"-").concat(e(),"-").concat(e()).concat(e()).concat(e())},t.parseURL=function(e){var n,t=/^([^:]+):\/\/([^\/:]*)(?::([\d]+))?(?:(\/[^#]*)(?:#(.*))?)?$/i,o=e.match(t);return o?{scheme:o[1].toLowerCase(),host:o[2].toLowerCase(),port:o[3],path:o[4]||"/",fragment:o[5],local:(n=o[1].toLowerCase(),!["http","https"].includes(n))}:{}},t.getUTMSourcesFromURL=function(e){for(var n,o=t.parseURL(e),r=o.path,i=/[?&]([^=#]+)=([^&#]*)/g,a=[];n=i.exec(r);)0===n[1].indexOf("utm_")&&a.push("".concat(n[1],"=").concat(n[2]));return a.join(";")},t.concatUnique=function(e,n){return e.concat(n).filter(function(e,n,t){return t.indexOf(e)===n})},t.parseDate=function(e){var n=new Date(e);if(isNaN(n.getTime())){var t=e.split(" "),r=o(t,2),i=r[0],a=r[1],u=i.split("-"),s=a.split(":");return new Date(u[0],u[1]-1,u[2],s[0],s[1],s[2])}return n},t.shuffle=function(e){for(var n=e.length,t=null,o=null;0!==n;)o=Math.floor(Math.random()*n),n--,t=e[n],e[n]=e[o],e[o]=t;return e},t.chunk=function(e,n){n=n<=0?1:n;for(var t=[],o=0,r=e.length;o<r;)t.push(e.slice(o,o+=n));return t},t.isChrome="undefined"==typeof browser,t.hashCode=function(e){var n=0;if("string"!=typeof e&&(e=JSON.stringify(e)),!e||0===e.length)return n;for(var t=0;t<e.length;t++){n=(n<<5)-n+e.charCodeAt(t),n&=n}return n},t.hashString=function(e){return t.hashCode(e).toString()}},{}],63:[function(e,n,t){"use strict";var o=["not_controllable","controlled_by_other_extensions"],r=e("../util"),i=function(e){chrome.privacy&&chrome.privacy.network.webRTCIPHandlingPolicy.get({},function(n){o.includes(n.levelOfControl)||e(n)})},a=function(e){return i(function(){return chrome.privacy.network.webRTCIPHandlingPolicy.set({value:e})})},u=function(){return i(function(){return chrome.privacy.network.webRTCIPHandlingPolicy.clear({scope:"regular"})})};t.disableNonProxiedUDP=function(){a(r.isChrome?"disable_non_proxied_udp":"proxy_only")},t.defaultPublicInterfaceOnly=function(){a("default_public_interface_only")},t.defaultPublicAndPrivateInterfaces=function(){a("default_public_and_private_interfaces")},t.default=function(){a("default")},t.clearWebrtcConfig=u},{"../util":62}],64:[function(e,n,t){(function(n){"use strict";function o(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},o=Object.keys(t);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(t).filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),o.forEach(function(n){r(e,n,t[n])})}return e}function r(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}var i="undefined"!=typeof window?window.Bacon:void 0!==n?n.Bacon:null,a=e("storage"),u=e("../popup"),s=u.popup,c=e("../permissions"),l=c.permissions,d=c.requestPermissions,f=e("../notifications"),p=(f.notify,f.clearAll),m=e("../util"),g=m.isChrome,b=e("./lists"),y=b.blacklist,w=(b.addToBlacklist,l.map(function(e){return e.includes("privacy")}).toProperty()),v=i.fromPromise(a.read("enable_webrtc_proxy")).flatMapError(function(){return!g}),h=i.fromEvent(s,"request:switchWebrtcProxy"),_=new i.Bus,L=i.mergeAll(v,h,_).combine(w,function(e,n){return!!e&&(!!n||(s.send("request:popupClose"),i.fromPromise(d(["privacy"]))))}).flatMapLatest(function(e){return e});L.onValue(function(e){a.write("enable_webrtc_proxy",e),p()});var x=i.fromBinder(function(e){return chrome.runtime.onMessage.addListener(function(n){var t=n.type,o=n.origin;"webrtc-call"===t&&e(o)})}).skipDuplicates(),k=L.toProperty();t.webrtcProxyEnabled=k,i.combineTemplate({webrtcProxyEnabled:k,blacklist:y}).sampledBy(x,function(e,n){return o({},e,{origin:n})}).filter(k.not()).filter(function(e){var n=e.blacklist,t=e.origin;return!n.includes(t)}).onValue(function(e){return e.origin,console.log("Tries to send Notification"),null})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../notifications":44,"../permissions":51,"../popup":52,"../util":62,"./lists":65,storage:56}],65:[function(e,n,t){(function(e){"use strict";var n="undefined"!=typeof window?window.Bacon:void 0!==e?e.Bacon:null,o=new n.Bus;t.blacklist=o.scan([],function(e,n){return e.includes(n)||e.push(n),e}),t.addToBlacklist=function(e){o.push(e)}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],66:[function(e,n,t){"use strict";function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function r(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function i(e,n){for(var t=0;t<n.length;t++){var o=n[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function a(e,n,t){return n&&i(e.prototype,n),t&&i(e,t),e}function u(e,n){return!n||"object"!==o(n)&&"function"!=typeof n?s(e):n}function s(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),n&&d(e,n)}function d(e,n){return(d=Object.setPrototypeOf||function(e,n){return e.__proto__=n,e})(e,n)}var f=(e("loglevel"),e("./emitter")),p=chrome.extension.getURL(""),m=function(){chrome.runtime.lastError},g=function(e){function n(){var e;return r(this,n),e=u(this,c(n).call(this)),e.active=!1,e.showMessage=!0,e.messages=null,e.shownInTabs=new Set,chrome.runtime.onMessage.addListener(function(n,t){if("getWidgetStatus"===n.subject){e.active&&e.shownInTabs.size<3&&!e.shownInTabs.has(t.tab.id)&&e.shownInTabs.add(t.tab.id);var o=e.active&&e.shownInTabs.has(t.tab.id);chrome.tabs.sendMessage(t.tab.id,{subject:"widgetStatus",payload:{active:o,extUrl:p}},{},m)}"getWidgetMessage"===n.subject&&chrome.tabs.sendMessage(t.tab.id,{subject:"widgetMessage",payload:{show:e.showMessage,extUrl:p,messages:e.messages}},{},m),"dismiss"!==n.subject&&"hideMessage"!==n.subject||e.trigger(n.subject,t),"getPremium"===n.subject&&e.trigger(n.subject,n.payload)}),e}return l(n,e),a(n,[{key:"toggle",value:function(e){var n=this;e!==this.active&&chrome.tabs.query({},function(t){return Array.from(t).forEach(function(t){var o=e&&n.shownInTabs.has(t.id);chrome.tabs.sendMessage(t.id,{subject:"widgetStatus",payload:{active:o,extUrl:p}},{},m)})}),this.active=e}},{key:"toggleMessage",value:function(e,n){this.messages=n,this.showMessage=e,chrome.tabs.query({},function(t){return Array.from(t).forEach(function(t){return chrome.tabs.sendMessage(t.id,{subject:"widgetMessage",payload:{show:e,extUrl:p,messages:n}},{},m)})})}}]),n}(f);n.exports=new g},{"./emitter":27,loglevel:1}],67:[function(e,n,t){(function(n){"use strict";function t(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},r=Object.keys(t);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t).filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.forEach(function(n){o(e,n,t[n])})}return e}function o(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}var r="undefined"!=typeof window?window.Bacon:void 0!==n?n.Bacon:null,i=e("browser"),a=e("widget-messages"),u=e("storage"),s=e("./url-resolver"),c=e("./crm"),l=e("./account"),d=l.user,f=e("./language"),p=f.messages,m=e("./enabled");r.fromPromise(u.read("widget_last_shown")).mapError(function(){return 0}).flatMapLatest(function(e){return r.later(Math.max(864e5+e-Date.now(),6e4),!0)}).merge(r.interval(864e5,!0)).merge(r.fromEvent(a,"getPremium").doAction(function(e){var n=e.url;n||(n=s("account/order",{utm_medium:"crm",utm_source:"extension-widget",utm_campaign:"premium-promotion"})),i.openPage(n)}).map(!1)).merge(r.fromEvent(a,"dismiss").map(!1)).toProperty().flatMapLatest(function(e){return r.combineAsArray(e,d,m)}).onValues(function(e,n,t){a.toggle(e&&n&&!n.is_premium&&!n.is_trial&&t),e&&u.write("widget_last_shown",Date.now())});var g=r.combineTemplate({user:d,messages:p,crm:c}).map(function(e){var n=e.user,o=e.messages,r=e.crm,i=n&&n.is_verified?"verified":"unverified";return t({},o.widget[i],r.widget)}).toProperty();r.once(!0).merge(r.interval(864e5,!0)).merge(r.fromEvent(a,"hideMessage").map(!1)).combine(g,function(e,n){return[e,n]}).onValues(function(e,n){return a.toggleMessage(e,n)})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./account":3,"./crm":16,"./enabled":28,"./language":36,"./url-resolver":61,browser:8,storage:56,"widget-messages":66}],68:[function(e,n,t){"use strict";function o(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},o=Object.keys(t);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(t).filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),o.forEach(function(n){r(e,n,t[n])})}return e}function r(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function i(e,n){return s(e)||u(e,n)||a()}function a(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function u(e,n){var t=[],o=!0,r=!1,i=void 0;try{for(var a,u=e[Symbol.iterator]();!(o=(a=u.next()).done)&&(t.push(a.value),!n||t.length!==n);o=!0);}catch(e){r=!0,i=e}finally{try{o||null==u.return||u.return()}finally{if(r)throw i}}return t}function s(e){if(Array.isArray(e))return e}var c=e("ua-parser-js"),l=e("./storage"),d=function(){return Promise.all([l.read("install_id",!1),l.read("install_source",!1),l.read("enabled",!1),l.read("default_location",!1),l.read("user",!1),l.read("device",!1),l.read("geo",!1),l.read("userDays",!1)]).then(function(e){var n=i(e,8),t=n[0],o=n[1],r=n[2],a=n[3],u=n[4],s=(n[5],n[6]),l=n[7],d=new c(navigator.userAgent).getResult();return{real_location:s,isPremium:(u||{}).is_premium||!1,isVerified:u&&u.is_verified,isAnonymous:u&&u.is_anonymous,selected_location:a,sku:((u||{}).subscription||{}).sku||"",email:(u||{}).email||"",account_type:(u||{}).account_type||"",active_product:(u||{}).account_type||"",zm_connected:r,install_source:o,install_id:t,os_name:d.os.name,os_ver:d.os.version,client_ver:chrome.runtime.getManifest().version,app_ver:chrome.runtime.getManifest().version,show_premium:!0,days_since_install:(l||{}).daysSinceInstall||0,days_since_premium:(l||{}).daysSincePremium||0,days_since_registration:(l||{}).daysSinceRegistration||0,days_to_free:Math.abs((l||"").daysToFree)||0,days_to_recur:Math.abs((l||"").daysToRecu)||0}})};t.request=function(e){var n=e.url,t=e.responseType,r=e.requestType,i=e.data,a=e.method,u=void 0===a?"GET":a,s=e.headers,c=void 0===s?{}:s,l=e.skipEnvParams,f=void 0!==l&&l;return d().then(function(e){var a=f?o({},i):o({},e,i);return new Promise(function(e,o){var s=new XMLHttpRequest,l="";if("GET"===u.toUpperCase()&&i){l="?".concat(Object.keys(a).map(function(e){return"".concat(encodeURIComponent(e),"=").concat(encodeURIComponent(a[e]))}).join("&"))}s.open(u,n+l),s.responseType=t||"";for(var d in c){var f=c[d];s.setRequestHeader(d,f)}var p=null;if(["POST","PUT"].includes(u.toUpperCase())&&i)if("json"===r)p=JSON.stringify(a),s.setRequestHeader("Content-Type","application/json; charset=UTF-8");else{p=new FormData;for(var m in a){var g=a[m];p.append(m,g)}}return s.onload=function(){if(s.status>=200&&s.status<300)return s.payload=s.response,e(s);var n=Error("Error");return n.type="onload",n.payload=s.response,n.status=s.status,o(n)},s.onerror=function(){var e=Error("Network Error");return e.type="onerror",e.payload=s.response,e.status=s.status,o(e)},s.ontimeout=function(){var e=Error("Request timeout");return e.type="ontimeout",o(e)},s.send(p)})})}},{"./storage":56,"ua-parser-js":2}],69:[function(e,n,t){"use strict";function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}!function(e,t){"object"===(void 0===n?"undefined":o(n))&&n.exports?n.exports=t:t()}(0,function(){function e(){window.__zm={toggle:function(e){document.dispatchEvent(new CustomEvent("toggle",{detail:e}))},setPageExcludes:function(e){document.dispatchEvent(new CustomEvent("setPageExcludes",{detail:e}))},update:function(){document.dispatchEvent(new CustomEvent("updateZM"))},removeCredentials:function(){document.dispatchEvent(new CustomEvent("removeCredentials"))},updateWithCredentials:function(e){document.dispatchEvent(new CustomEvent("updateWithCredentials",{detail:e}))},
getData:function(e){var n=Date.now();document.dispatchEvent(new CustomEvent("request:getData",{detail:n}));var t=function t(o){var r=JSON.parse(o.detail);r.timestamp===n&&e&&(e({user:r.user,device:r.device,version:r.version}),document.removeEventListener("response:getData",t))};document.addEventListener("response:getData",t)}}}var n="(".concat(e,")();");document.addEventListener("toggle",function(e){chrome.runtime.sendMessage({subject:"toggle",payload:e.detail})}),document.addEventListener("setPageExcludes",function(e){chrome.runtime.sendMessage({subject:"setPageExcludes",payload:e.detail})}),document.addEventListener("updateZM",function(){chrome.runtime.sendMessage({subject:"update"})}),document.addEventListener("removeCredentials",function(){chrome.runtime.sendMessage({subject:"removeCredentials"})}),document.addEventListener("updateWithCredentials",function(e){chrome.runtime.sendMessage({subject:"updateWithCredentials",payload:{credentials:e.detail}})}),document.addEventListener("request:getData",function(e){chrome.runtime.sendMessage({subject:"request:getData",payload:{timestamp:e.detail}})}),chrome.runtime.onMessage.addListener(function(e){e&&e.subject&&document.dispatchEvent(new CustomEvent(e.subject,{detail:JSON.stringify(e.payload)}))});var t=document.createElement("script");t.innerHTML=n,(document.body||document.head||document.documentElement).appendChild(t)})},{}]},{},[34]);